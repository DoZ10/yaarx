\hypertarget{tea_8cc}{\subsection{src/tea.cc \-File \-Reference}
\label{tea_8cc}\index{src/tea.\-cc@{src/tea.\-cc}}
}


\-Common functions used in the analysis of \-T\-E\-A.  


{\ttfamily \#include \char`\"{}common.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}tea.\-hh\char`\"{}}\*
\subsubsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{tea_8cc_a40525ecf9356be561e0c340bf5733ad2}{tea\-\_\-encrypt} (uint32\-\_\-t $\ast$v, uint32\-\_\-t $\ast$k, int nrounds)
\item 
uint32\-\_\-t \hyperlink{tea_8cc_ac48211a6f68e2f7a77996cbb3f08fa65}{tea\-\_\-f} (uint32\-\_\-t x, uint32\-\_\-t k0, uint32\-\_\-t k1, uint32\-\_\-t delta, uint32\-\_\-t lsh\-\_\-const, uint32\-\_\-t rsh\-\_\-const)
\item 
uint32\-\_\-t \hyperlink{tea_8cc_a954e4605d99d98c4f62787b1b6efa9a6}{tea\-\_\-f\-\_\-i} (const uint32\-\_\-t mask\-\_\-i, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const, const uint32\-\_\-t x\-\_\-in)
\item 
void \hyperlink{tea_8cc_ab306a4cede2b1c148d48c87ee024252c}{tea\-\_\-compute\-\_\-delta\-\_\-const} (uint32\-\_\-t \-D\mbox{[}\hyperlink{tea_8hh_a731ff0e924a27e36c0f7bc72a7d383c5}{\-T\-E\-A\-\_\-\-N\-C\-Y\-C\-L\-E\-S}\mbox{]})
\item 
double \hyperlink{tea_8cc_a017d938e2967f497987d4a77000b043a}{tea\-\_\-add\-\_\-diff\-\_\-adjust\-\_\-to\-\_\-key} (const uint64\-\_\-t npairs, const int round\-\_\-idx, const uint32\-\_\-t da, const uint32\-\_\-t db, const uint32\-\_\-t key\mbox{[}4\mbox{]})
\item 
double \hyperlink{tea_8cc_aadbe72956ed93bb2093fbd10e967f1a6}{tea\-\_\-differential\-\_\-thres\-\_\-exper\-\_\-fk} (uint64\-\_\-t npairs, int r, uint32\-\_\-t key\mbox{[}4\mbox{]}, uint32\-\_\-t da\mbox{[}2\mbox{]}, uint32\-\_\-t db\mbox{[}2\mbox{]})
\item 
uint32\-\_\-t \hyperlink{tea_8cc_aad728904852ace44041654d3b06c8288}{tea\-\_\-add\-\_\-verify\-\_\-trail} (uint32\-\_\-t nrounds, uint32\-\_\-t npairs, uint32\-\_\-t key\mbox{[}4\mbox{]}, \hyperlink{structdifferential__t}{differential\-\_\-t} trail\mbox{[}\-N\-R\-O\-U\-N\-D\-S\mbox{]})
\item 
uint32\-\_\-t \hyperlink{tea_8cc_a47790679b78464d5ee2d0d6dc7d579bc}{tea\-\_\-add\-\_\-verify\-\_\-differential} (uint32\-\_\-t nrounds, uint32\-\_\-t npairs, uint32\-\_\-t key\mbox{[}4\mbox{]}, \hyperlink{structdifferential__t}{differential\-\_\-t} trail\mbox{[}\-N\-R\-O\-U\-N\-D\-S\mbox{]})
\item 
void \hyperlink{tea_8cc_a8d1af56a9274681157258b784791bd06}{print\-\_\-trail\-\_\-latex} (\-F\-I\-L\-E $\ast$fp, uint32\-\_\-t nrounds, uint32\-\_\-t keys\mbox{[}4\mbox{]}, \hyperlink{structdifferential__t}{differential\-\_\-t} trail\mbox{[}\-N\-R\-O\-U\-N\-D\-S\mbox{]})
\end{DoxyCompactItemize}


\subsubsection{\-Detailed \-Description}
\-Common functions used in the analysis of \-T\-E\-A. \begin{DoxyAuthor}{\-Author}
\-V.\-Velichkov, \href{mailto:vesselin.velichkov@uni.lu}{\tt vesselin.\-velichkov@uni.\-lu} 
\end{DoxyAuthor}


\subsubsection{\-Function \-Documentation}
\hypertarget{tea_8cc_a8d1af56a9274681157258b784791bd06}{\index{tea.\-cc@{tea.\-cc}!print\-\_\-trail\-\_\-latex@{print\-\_\-trail\-\_\-latex}}
\index{print\-\_\-trail\-\_\-latex@{print\-\_\-trail\-\_\-latex}!tea.cc@{tea.\-cc}}
\paragraph[{print\-\_\-trail\-\_\-latex}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf print\-\_\-trail\-\_\-latex} (
\begin{DoxyParamCaption}
\item[{\-F\-I\-L\-E $\ast$}]{fp, }
\item[{uint32\-\_\-t}]{nrounds, }
\item[{uint32\-\_\-t}]{keys\mbox{[}4\mbox{]}, }
\item[{{\bf differential\-\_\-t}}]{trail\mbox{[}\-N\-R\-O\-U\-N\-D\-S\mbox{]}}
\end{DoxyParamCaption}
)}}\label{tea_8cc_a8d1af56a9274681157258b784791bd06}
\-Print a differential trail in \-La\-Te\-X-\/formatted style, suitable to add in a \-La\-Te\-X document.


\begin{DoxyParams}{\-Parameters}
{\em fp} & \-F\-I\-L\-E pointer for writing; opened and closed by the calling function. \\
\hline
{\em nrounds} & number of rounds covered by the trail (\-N\-R\-O\-U\-N\-D\-S). \\
\hline
{\em keys} & cryptographic key of \-T\-E\-A. \\
\hline
{\em trail} & differential trail for {\ttfamily nrounds}. \\
\hline
\end{DoxyParams}
\hypertarget{tea_8cc_a017d938e2967f497987d4a77000b043a}{\index{tea.\-cc@{tea.\-cc}!tea\-\_\-add\-\_\-diff\-\_\-adjust\-\_\-to\-\_\-key@{tea\-\_\-add\-\_\-diff\-\_\-adjust\-\_\-to\-\_\-key}}
\index{tea\-\_\-add\-\_\-diff\-\_\-adjust\-\_\-to\-\_\-key@{tea\-\_\-add\-\_\-diff\-\_\-adjust\-\_\-to\-\_\-key}!tea.cc@{tea.\-cc}}
\paragraph[{tea\-\_\-add\-\_\-diff\-\_\-adjust\-\_\-to\-\_\-key}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf tea\-\_\-add\-\_\-diff\-\_\-adjust\-\_\-to\-\_\-key} (
\begin{DoxyParamCaption}
\item[{const uint64\-\_\-t}]{npairs, }
\item[{const int}]{round\-\_\-idx, }
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{db, }
\item[{const uint32\-\_\-t}]{key\mbox{[}4\mbox{]}}
\end{DoxyParamCaption}
)}}\label{tea_8cc_a017d938e2967f497987d4a77000b043a}
\-Experimentally adjust the probability of a differential for one round of \-T\-E\-A to a fixed key over a number of chosen plaintexts.


\begin{DoxyParams}{\-Parameters}
{\em npairs} & number of chosen plaintext pairs (\hyperlink{common_8hh_ad8bbd29e2946d6b269e0009219061ad6}{\-N\-P\-A\-I\-R\-S}). \\
\hline
{\em round\-\_\-idx} & index of the round. \\
\hline
{\em da} & input difference to the \-T\-E\-A \-F function. \\
\hline
{\em db} & output difference from the \-T\-E\-A \-F function. \\
\hline
{\em key} & cryptographic key of \-T\-E\-A. \\
\hline
\end{DoxyParams}
\hypertarget{tea_8cc_a47790679b78464d5ee2d0d6dc7d579bc}{\index{tea.\-cc@{tea.\-cc}!tea\-\_\-add\-\_\-verify\-\_\-differential@{tea\-\_\-add\-\_\-verify\-\_\-differential}}
\index{tea\-\_\-add\-\_\-verify\-\_\-differential@{tea\-\_\-add\-\_\-verify\-\_\-differential}!tea.cc@{tea.\-cc}}
\paragraph[{tea\-\_\-add\-\_\-verify\-\_\-differential}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t {\bf tea\-\_\-add\-\_\-verify\-\_\-differential} (
\begin{DoxyParamCaption}
\item[{uint32\-\_\-t}]{nrounds, }
\item[{uint32\-\_\-t}]{npairs, }
\item[{uint32\-\_\-t}]{key\mbox{[}4\mbox{]}, }
\item[{{\bf differential\-\_\-t}}]{trail\mbox{[}\-N\-R\-O\-U\-N\-D\-S\mbox{]}}
\end{DoxyParamCaption}
)}}\label{tea_8cc_a47790679b78464d5ee2d0d6dc7d579bc}
\-Given an \-A\-D\-D trail for $N$ rounds of \-T\-E\-A, experimentally verify the probabilities of the corresponding $N$ differentials\-:


\begin{DoxyItemize}
\item \-Differential for 1 round\-: round 0.
\item \-Differential for 2 rounds\-: rounds $0,1$.
\item \-Differential for 3 rounds\-: rounds $0,1,2$.
\item $\ldots$
\item \-Differential for $N$ rounds\-: rounds $0,1,2,\ldots,(N-1)$.
\end{DoxyItemize}


\begin{DoxyParams}{\-Parameters}
{\em nrounds} & number of rounds covered by the trail (\-N\-R\-O\-U\-N\-D\-S). \\
\hline
{\em npairs} & number of chosen plaintext pairs (\hyperlink{common_8hh_ad8bbd29e2946d6b269e0009219061ad6}{\-N\-P\-A\-I\-R\-S}). \\
\hline
{\em key} & cryptographic key of \-T\-E\-A. \\
\hline
{\em trail} & differential trail for {\ttfamily nrounds}. \\
\hline
\end{DoxyParams}
\hypertarget{tea_8cc_aad728904852ace44041654d3b06c8288}{\index{tea.\-cc@{tea.\-cc}!tea\-\_\-add\-\_\-verify\-\_\-trail@{tea\-\_\-add\-\_\-verify\-\_\-trail}}
\index{tea\-\_\-add\-\_\-verify\-\_\-trail@{tea\-\_\-add\-\_\-verify\-\_\-trail}!tea.cc@{tea.\-cc}}
\paragraph[{tea\-\_\-add\-\_\-verify\-\_\-trail}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t {\bf tea\-\_\-add\-\_\-verify\-\_\-trail} (
\begin{DoxyParamCaption}
\item[{uint32\-\_\-t}]{nrounds, }
\item[{uint32\-\_\-t}]{npairs, }
\item[{uint32\-\_\-t}]{key\mbox{[}4\mbox{]}, }
\item[{{\bf differential\-\_\-t}}]{trail\mbox{[}\-N\-R\-O\-U\-N\-D\-S\mbox{]}}
\end{DoxyParamCaption}
)}}\label{tea_8cc_aad728904852ace44041654d3b06c8288}
\-Experimentally verify the probability of all 1-\/round differentials from which an \-N round \-A\-D\-D trail for \-T\-E\-A is composed.


\begin{DoxyParams}{\-Parameters}
{\em nrounds} & number of rounds covered by the trail (\-N\-R\-O\-U\-N\-D\-S). \\
\hline
{\em npairs} & number of chosen plaintext pairs (\hyperlink{common_8hh_ad8bbd29e2946d6b269e0009219061ad6}{\-N\-P\-A\-I\-R\-S}). \\
\hline
{\em key} & cryptographic key of \-T\-E\-A. \\
\hline
{\em trail} & differential trail for {\ttfamily nrounds}. \\
\hline
\end{DoxyParams}
\hypertarget{tea_8cc_ab306a4cede2b1c148d48c87ee024252c}{\index{tea.\-cc@{tea.\-cc}!tea\-\_\-compute\-\_\-delta\-\_\-const@{tea\-\_\-compute\-\_\-delta\-\_\-const}}
\index{tea\-\_\-compute\-\_\-delta\-\_\-const@{tea\-\_\-compute\-\_\-delta\-\_\-const}!tea.cc@{tea.\-cc}}
\paragraph[{tea\-\_\-compute\-\_\-delta\-\_\-const}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf tea\-\_\-compute\-\_\-delta\-\_\-const} (
\begin{DoxyParamCaption}
\item[{uint32\-\_\-t}]{\-D\mbox{[}\-T\-E\-A\-\_\-\-N\-C\-Y\-C\-L\-E\-S\mbox{]}}
\end{DoxyParamCaption}
)}}\label{tea_8cc_ab306a4cede2b1c148d48c87ee024252c}
\-Compute all round constants of block cipher \-T\-E\-A.


\begin{DoxyParams}{\-Parameters}
{\em \-D} & all round constants $\delta$ of \-T\-E\-A. \\
\hline
\end{DoxyParams}
\hypertarget{tea_8cc_aadbe72956ed93bb2093fbd10e967f1a6}{\index{tea.\-cc@{tea.\-cc}!tea\-\_\-differential\-\_\-thres\-\_\-exper\-\_\-fk@{tea\-\_\-differential\-\_\-thres\-\_\-exper\-\_\-fk}}
\index{tea\-\_\-differential\-\_\-thres\-\_\-exper\-\_\-fk@{tea\-\_\-differential\-\_\-thres\-\_\-exper\-\_\-fk}!tea.cc@{tea.\-cc}}
\paragraph[{tea\-\_\-differential\-\_\-thres\-\_\-exper\-\_\-fk}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf tea\-\_\-differential\-\_\-thres\-\_\-exper\-\_\-fk} (
\begin{DoxyParamCaption}
\item[{uint64\-\_\-t}]{npairs, }
\item[{int}]{r, }
\item[{uint32\-\_\-t}]{key\mbox{[}4\mbox{]}, }
\item[{uint32\-\_\-t}]{da\mbox{[}2\mbox{]}, }
\item[{uint32\-\_\-t}]{db\mbox{[}2\mbox{]}}
\end{DoxyParamCaption}
)}}\label{tea_8cc_aadbe72956ed93bb2093fbd10e967f1a6}
\-Experimentally verify the probability of an {\ttfamily r} round differential for \-T\-E\-A, for a fixed key, over a number of chosen plaintexts.


\begin{DoxyParams}{\-Parameters}
{\em npairs} & number of chosen plaintext pairs (\hyperlink{common_8hh_ad8bbd29e2946d6b269e0009219061ad6}{\-N\-P\-A\-I\-R\-S}). \\
\hline
{\em r} & number of rounds (1 $\le$ {\ttfamily nrounds} $\le$ 64). \\
\hline
{\em da} & input state to round {\ttfamily 1}. \\
\hline
{\em db} & output state after round {\ttfamily r}. \\
\hline
{\em key} & cryptographic key of \-T\-E\-A. \\
\hline
\end{DoxyParams}
\hypertarget{tea_8cc_a40525ecf9356be561e0c340bf5733ad2}{\index{tea.\-cc@{tea.\-cc}!tea\-\_\-encrypt@{tea\-\_\-encrypt}}
\index{tea\-\_\-encrypt@{tea\-\_\-encrypt}!tea.cc@{tea.\-cc}}
\paragraph[{tea\-\_\-encrypt}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf tea\-\_\-encrypt} (
\begin{DoxyParamCaption}
\item[{uint32\-\_\-t $\ast$}]{v, }
\item[{uint32\-\_\-t $\ast$}]{k, }
\item[{int}]{nrounds}
\end{DoxyParamCaption}
)}}\label{tea_8cc_a40525ecf9356be561e0c340bf5733ad2}
\-Round-\/reduced version of block cipher \-T\-E\-A. \-Reference\-: \href{https://en.wikipedia.org/wiki/Tiny_Encryption_Algorithm}{\tt https\-://en.\-wikipedia.\-org/wiki/\-Tiny\-\_\-\-Encryption\-\_\-\-Algorithm}.


\begin{DoxyParams}{\-Parameters}
{\em v} & plaintext. \\
\hline
{\em k} & secret key. \\
\hline
{\em nrounds} & number of rounds (1 $\le$ {\ttfamily nrounds} $\le$ 64). \\
\hline
\end{DoxyParams}
\hypertarget{tea_8cc_ac48211a6f68e2f7a77996cbb3f08fa65}{\index{tea.\-cc@{tea.\-cc}!tea\-\_\-f@{tea\-\_\-f}}
\index{tea\-\_\-f@{tea\-\_\-f}!tea.cc@{tea.\-cc}}
\paragraph[{tea\-\_\-f}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t {\bf tea\-\_\-f} (
\begin{DoxyParamCaption}
\item[{uint32\-\_\-t}]{x, }
\item[{uint32\-\_\-t}]{k0, }
\item[{uint32\-\_\-t}]{k1, }
\item[{uint32\-\_\-t}]{delta, }
\item[{uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{tea_8cc_ac48211a6f68e2f7a77996cbb3f08fa65}
\-The \-F-\/function of block cipher \-T\-E\-A\-: $ F(x) = ((x \ll 4) + k_0) \oplus (x + \delta) \oplus ((x \gg 5) + k_1)$.


\begin{DoxyParams}{\-Parameters}
{\em x} & input to $F$. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant (default is 4). \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant (default is 5). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$F(x)$ 
\end{DoxyReturn}
\hypertarget{tea_8cc_a954e4605d99d98c4f62787b1b6efa9a6}{\index{tea.\-cc@{tea.\-cc}!tea\-\_\-f\-\_\-i@{tea\-\_\-f\-\_\-i}}
\index{tea\-\_\-f\-\_\-i@{tea\-\_\-f\-\_\-i}!tea.cc@{tea.\-cc}}
\paragraph[{tea\-\_\-f\-\_\-i}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t {\bf tea\-\_\-f\-\_\-i} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{mask\-\_\-i, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{x\-\_\-in}
\end{DoxyParamCaption}
)}}\label{tea_8cc_a954e4605d99d98c4f62787b1b6efa9a6}
\-The \-F-\/function of block cipher \-T\-E\-A (\hyperlink{tea_8hh_ac48211a6f68e2f7a77996cbb3f08fa65}{tea\-\_\-f}) computed on the first {\ttfamily i} least-\/significant (\-L\-S) bits.


\begin{DoxyParams}{\-Parameters}
{\em mask\-\_\-i} & {\ttfamily i} bit \-L\-S\-B mask. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant (default is 4). \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant (default is 5). \\
\hline
{\em x\-\_\-in} & input to $F$. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$F(x)~ \mathrm{mod}~ 2^i$
\end{DoxyReturn}
\begin{DoxyAttention}{\-Attention}
the initial value {\ttfamily x\-\_\-in} must be minimum ({\ttfamily rsh\-\_\-const} + 1) bits long so that it can be shifted right by {\ttfamily rsh\-\_\-const} positions.
\end{DoxyAttention}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{xtea_8cc_a6c0b7a7bc47458fb343e66188fe4abda}{xtea\-\_\-f()} 
\end{DoxySeeAlso}

\hypertarget{max-adp-xor3_8cc}{\subsection{src/max-\/adp-\/xor3.cc \-File \-Reference}
\label{max-adp-xor3_8cc}\index{src/max-\/adp-\/xor3.\-cc@{src/max-\/adp-\/xor3.\-cc}}
}


\-The maximum \-A\-D\-D differential probability of \-X\-O\-R with three inputs\-: $\max_{dd}~\mathrm{adp}^{3\oplus}(da, db, dc \rightarrow dd)$.  


{\ttfamily \#include \char`\"{}common.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}adp-\/xor3.\-hh\char`\"{}}\*
\subsubsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{max-adp-xor3_8cc_ad25cee0908ad1bc426aae280885d7581}{max\-\_\-adp\-\_\-xor3\-\_\-i} (const int i, const uint32\-\_\-t k, const uint32\-\_\-t n, double $\ast$p, uint32\-\_\-t $\ast$dd, gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, gsl\-\_\-vector $\ast$\-B\mbox{[}\hyperlink{common_8hh_a92ed8507d1cd2331ad09275c5c4c1c89}{\-W\-O\-R\-D\-\_\-\-S\-I\-Z\-E}+1\mbox{]}, gsl\-\_\-vector $\ast$\-C, const uint32\-\_\-t da, const uint32\-\_\-t db, const uint32\-\_\-t dc, uint32\-\_\-t $\ast$dd\-\_\-max, double $\ast$p\-\_\-max)
\item 
void \hyperlink{max-adp-xor3_8cc_a7134183c8951be68d7e94f47793d2f0d}{max\-\_\-adp\-\_\-xor3\-\_\-bounds} (gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, gsl\-\_\-vector $\ast$\-B\mbox{[}\hyperlink{common_8hh_a92ed8507d1cd2331ad09275c5c4c1c89}{\-W\-O\-R\-D\-\_\-\-S\-I\-Z\-E}+1\mbox{]}, const uint32\-\_\-t da, const uint32\-\_\-t db, const uint32\-\_\-t dc, uint32\-\_\-t $\ast$dd\-\_\-max)
\item 
double \hyperlink{max-adp-xor3_8cc_aa606808c54de33ad16170106454312a7}{max\-\_\-adp\-\_\-xor3} (gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, const uint32\-\_\-t da, const uint32\-\_\-t db, const uint32\-\_\-t dc, uint32\-\_\-t $\ast$dd\-\_\-max)
\item 
void \hyperlink{max-adp-xor3_8cc_a6033c1a639b25e76ffcecd62569fbd05}{max\-\_\-adp\-\_\-xor3\-\_\-rec\-\_\-i} (const uint32\-\_\-t k, const uint32\-\_\-t n, double $\ast$p, uint32\-\_\-t $\ast$dd, gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, gsl\-\_\-vector $\ast$\-C, const uint32\-\_\-t da, const uint32\-\_\-t db, const uint32\-\_\-t dc, uint32\-\_\-t $\ast$dd\-\_\-max, double $\ast$p\-\_\-max)
\item 
double \hyperlink{max-adp-xor3_8cc_ad2234c23808b10a3c3b64962c4d24198}{max\-\_\-adp\-\_\-xor3\-\_\-rec} (gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, gsl\-\_\-vector $\ast$\-C, const uint32\-\_\-t da, const uint32\-\_\-t db, const uint32\-\_\-t dc, uint32\-\_\-t $\ast$dd\-\_\-max)
\item 
double \hyperlink{max-adp-xor3_8cc_a44675228e7739c23660939671bc022c4}{max\-\_\-adp\-\_\-xor3\-\_\-exper} (gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, const uint32\-\_\-t da, const uint32\-\_\-t db, const uint32\-\_\-t dc, uint32\-\_\-t $\ast$dd\-\_\-max)
\end{DoxyCompactItemize}


\subsubsection{\-Detailed \-Description}
\-The maximum \-A\-D\-D differential probability of \-X\-O\-R with three inputs\-: $\max_{dd}~\mathrm{adp}^{3\oplus}(da, db, dc \rightarrow dd)$. \begin{DoxyAuthor}{\-Author}
\-V.\-Velichkov, \href{mailto:vesselin.velichkov@uni.lu}{\tt vesselin.\-velichkov@uni.\-lu} 
\end{DoxyAuthor}


\subsubsection{\-Function \-Documentation}
\hypertarget{max-adp-xor3_8cc_aa606808c54de33ad16170106454312a7}{\index{max-\/adp-\/xor3.\-cc@{max-\/adp-\/xor3.\-cc}!max\-\_\-adp\-\_\-xor3@{max\-\_\-adp\-\_\-xor3}}
\index{max\-\_\-adp\-\_\-xor3@{max\-\_\-adp\-\_\-xor3}!max-adp-xor3.cc@{max-\/adp-\/xor3.\-cc}}
\paragraph[{max\-\_\-adp\-\_\-xor3}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-adp\-\_\-xor3} (
\begin{DoxyParamCaption}
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{db, }
\item[{const uint32\-\_\-t}]{dc, }
\item[{uint32\-\_\-t $\ast$}]{dd\-\_\-max}
\end{DoxyParamCaption}
)}}\label{max-adp-xor3_8cc_aa606808c54de33ad16170106454312a7}
\-Compute the maximum differential probability over all output differences\-: $\mathrm{max}_{dc}~\mathrm{adp}^{\oplus}(da,db,dc \rightarrow dd)$. {\bfseries \-Complexity} c\-: $O(n) \le c \le O(2^n)$.


\begin{DoxyParams}{\-Parameters}
{\em \-A} & transition probability matrices. \\
\hline
{\em da} & first input difference. \\
\hline
{\em db} & second input difference. \\
\hline
{\em dc} & third input difference. \\
\hline
{\em dd\-\_\-max} & maximum probability output difference.\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{max-adp-xor3_8hh_a7134183c8951be68d7e94f47793d2f0d}{max\-\_\-adp\-\_\-xor3\-\_\-bounds}, \hyperlink{max-adp-xor3_8hh_ad25cee0908ad1bc426aae280885d7581}{max\-\_\-adp\-\_\-xor3\-\_\-i} 
\end{DoxySeeAlso}
\hypertarget{max-adp-xor3_8cc_a7134183c8951be68d7e94f47793d2f0d}{\index{max-\/adp-\/xor3.\-cc@{max-\/adp-\/xor3.\-cc}!max\-\_\-adp\-\_\-xor3\-\_\-bounds@{max\-\_\-adp\-\_\-xor3\-\_\-bounds}}
\index{max\-\_\-adp\-\_\-xor3\-\_\-bounds@{max\-\_\-adp\-\_\-xor3\-\_\-bounds}!max-adp-xor3.cc@{max-\/adp-\/xor3.\-cc}}
\paragraph[{max\-\_\-adp\-\_\-xor3\-\_\-bounds}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf max\-\_\-adp\-\_\-xor3\-\_\-bounds} (
\begin{DoxyParamCaption}
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{gsl\-\_\-vector $\ast$}]{\-B\mbox{[}\-W\-O\-R\-D\-\_\-\-S\-I\-Z\-E+1\mbox{]}, }
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{db, }
\item[{const uint32\-\_\-t}]{dc, }
\item[{uint32\-\_\-t $\ast$}]{dd\-\_\-max}
\end{DoxyParamCaption}
)}}\label{max-adp-xor3_8cc_a7134183c8951be68d7e94f47793d2f0d}
\-Compute an array of bounds that can be used in the computation of the maximum differential probability.


\begin{DoxyParams}{\-Parameters}
{\em \-A} & transition probability matrices. \\
\hline
{\em \-B} & array of size {\ttfamily \-A\-\_\-size} rows by ({\ttfamily n} + 1) columns containing upper bounds on the maximum probabilities of all {\ttfamily j} bit differentials $n \ge j \ge 1$ beginning from any state {\ttfamily i\-:} {\ttfamily \-A\-\_\-size} $> i \ge 0$. \\
\hline
{\em da} & first input difference. \\
\hline
{\em db} & second input difference. \\
\hline
{\em dc} & third input difference. \\
\hline
{\em dd\-\_\-max} & maximum probability output difference.\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{max-adp-xor_8hh_ab44746fae93c11ea36bd24f4f874669d}{max\-\_\-adp\-\_\-xor\-\_\-bounds}, \hyperlink{max-adp-xor3_8hh_ad25cee0908ad1bc426aae280885d7581}{max\-\_\-adp\-\_\-xor3\-\_\-i} 
\end{DoxySeeAlso}
\hypertarget{max-adp-xor3_8cc_a44675228e7739c23660939671bc022c4}{\index{max-\/adp-\/xor3.\-cc@{max-\/adp-\/xor3.\-cc}!max\-\_\-adp\-\_\-xor3\-\_\-exper@{max\-\_\-adp\-\_\-xor3\-\_\-exper}}
\index{max\-\_\-adp\-\_\-xor3\-\_\-exper@{max\-\_\-adp\-\_\-xor3\-\_\-exper}!max-adp-xor3.cc@{max-\/adp-\/xor3.\-cc}}
\paragraph[{max\-\_\-adp\-\_\-xor3\-\_\-exper}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-adp\-\_\-xor3\-\_\-exper} (
\begin{DoxyParamCaption}
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{db, }
\item[{const uint32\-\_\-t}]{dc, }
\item[{uint32\-\_\-t $\ast$}]{dd\-\_\-max}
\end{DoxyParamCaption}
)}}\label{max-adp-xor3_8cc_a44675228e7739c23660939671bc022c4}
\-Compute the maximum differential probability by exhaustive search over all output differences. {\bfseries \-Complexity\-:} $O(2^n)$.


\begin{DoxyParams}{\-Parameters}
{\em \-A} & transition probability matrices. \\
\hline
{\em da} & first input difference. \\
\hline
{\em db} & second input difference. \\
\hline
{\em dc} & third input difference. \\
\hline
{\em dd\-\_\-max} & maximum probability output difference. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dd}~\mathrm{adp}^{\oplus}(da,db,dc \rightarrow dd)$
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{max-adp-xor_8hh_aa66f59ae4d29988f90f525ce600d6045}{max\-\_\-adp\-\_\-xor} 
\end{DoxySeeAlso}
\hypertarget{max-adp-xor3_8cc_ad25cee0908ad1bc426aae280885d7581}{\index{max-\/adp-\/xor3.\-cc@{max-\/adp-\/xor3.\-cc}!max\-\_\-adp\-\_\-xor3\-\_\-i@{max\-\_\-adp\-\_\-xor3\-\_\-i}}
\index{max\-\_\-adp\-\_\-xor3\-\_\-i@{max\-\_\-adp\-\_\-xor3\-\_\-i}!max-adp-xor3.cc@{max-\/adp-\/xor3.\-cc}}
\paragraph[{max\-\_\-adp\-\_\-xor3\-\_\-i}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf max\-\_\-adp\-\_\-xor3\-\_\-i} (
\begin{DoxyParamCaption}
\item[{const int}]{i, }
\item[{const uint32\-\_\-t}]{k, }
\item[{const uint32\-\_\-t}]{n, }
\item[{double $\ast$}]{p, }
\item[{uint32\-\_\-t $\ast$}]{dd, }
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{gsl\-\_\-vector $\ast$}]{\-B\mbox{[}\-W\-O\-R\-D\-\_\-\-S\-I\-Z\-E+1\mbox{]}, }
\item[{gsl\-\_\-vector $\ast$}]{\-C, }
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{db, }
\item[{const uint32\-\_\-t}]{dc, }
\item[{uint32\-\_\-t $\ast$}]{dd\-\_\-max, }
\item[{double $\ast$}]{p\-\_\-max}
\end{DoxyParamCaption}
)}}\label{max-adp-xor3_8cc_ad25cee0908ad1bc426aae280885d7581}
\-Compute an upper bound $B[k][i]$ on the maximum probability of the differential $(da[n-1:k], db[n-1:k], dc[n-1:k] \rightarrow dd[n-1:k])$ starting from initial state {\ttfamily i} of the \-S-\/function given the upper bounds $B[k][i]$ on the probabilities of the differentials $(da[n-1:j], db[n-1:j], dc[n-1:j] \rightarrow dd[n-1:j])$ for $j = k+1, k+2, \ldots, n-1$.


\begin{DoxyParams}{\-Parameters}
{\em i} & index of the state of the \-S-\/function\-: {\ttfamily \-A\-\_\-size} $> i \ge 0$. \\
\hline
{\em k} & current bit position\-: $ n > k \ge 0$. \\
\hline
{\em n} & word size. \\
\hline
{\em p} & the transition probability of state {\ttfamily i} at bit position {\ttfamily k}. \\
\hline
{\em dd} & output difference. \\
\hline
{\em \-A} & transition probability matrices. \\
\hline
{\em \-B} & array of size {\ttfamily \-A\-\_\-size} rows by ({\ttfamily n} + 1) columns containing upper bounds on the maximum probabilities of all {\ttfamily j} bit differentials $n \ge j \ge 1$ beginning from any state {\ttfamily i\-:} {\ttfamily \-A\-\_\-size} $> i \ge 0$. \\
\hline
{\em \-C} & unit row vector of size {\ttfamily \-A\-\_\-size} rows, initialized with 1 at state index {\ttfamily i}. \\
\hline
{\em da} & first input difference. \\
\hline
{\em db} & second input difference. \\
\hline
{\em dc} & third input difference. \\
\hline
{\em dd\-\_\-max} & maximum probability output difference. \\
\hline
{\em p\-\_\-max} & the maximum probability.\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{max-adp-xor_8hh_a2c8bd5dba3223b07f3606c2240d0a4b2}{max\-\_\-adp\-\_\-xor\-\_\-i} 
\end{DoxySeeAlso}
\hypertarget{max-adp-xor3_8cc_ad2234c23808b10a3c3b64962c4d24198}{\index{max-\/adp-\/xor3.\-cc@{max-\/adp-\/xor3.\-cc}!max\-\_\-adp\-\_\-xor3\-\_\-rec@{max\-\_\-adp\-\_\-xor3\-\_\-rec}}
\index{max\-\_\-adp\-\_\-xor3\-\_\-rec@{max\-\_\-adp\-\_\-xor3\-\_\-rec}!max-adp-xor3.cc@{max-\/adp-\/xor3.\-cc}}
\paragraph[{max\-\_\-adp\-\_\-xor3\-\_\-rec}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-adp\-\_\-xor3\-\_\-rec} (
\begin{DoxyParamCaption}
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{gsl\-\_\-vector $\ast$}]{\-C, }
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{db, }
\item[{const uint32\-\_\-t}]{dc, }
\item[{uint32\-\_\-t $\ast$}]{dd\-\_\-max}
\end{DoxyParamCaption}
)}}\label{max-adp-xor3_8cc_ad2234c23808b10a3c3b64962c4d24198}
\-Recursively compute the maximum differential probability over all output differences\-: $\mathrm{max}_{dd}~\mathrm{adp}^{\oplus}(da,db,dc \rightarrow dd)$. {\bfseries \-Complexity} c\-: $O(n) \le c \le O(2^n)$.


\begin{DoxyParams}{\-Parameters}
{\em \-A} & transition probability matrices. \\
\hline
{\em \-C} & unit row vector initialized with 1 at the nitial state. \\
\hline
{\em da} & first input difference. \\
\hline
{\em db} & second input difference. \\
\hline
{\em dc} & third input difference. \\
\hline
{\em dd\-\_\-max} & maximum probability output difference. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dd}~\mathrm{adp}^{\oplus}(da,db,dc \rightarrow dd)$
\end{DoxyReturn}
\begin{DoxyNote}{\-Note}
\-This function \hyperlink{max-adp-xor3_8hh_ad2234c23808b10a3c3b64962c4d24198}{max\-\_\-adp\-\_\-xor3\-\_\-rec} is more efficient than exhaustive search over all output differences \hyperlink{max-adp-xor3_8hh_a44675228e7739c23660939671bc022c4}{max\-\_\-adp\-\_\-xor3\-\_\-exper}, but is less efficient than the function \hyperlink{max-adp-xor3_8hh_aa606808c54de33ad16170106454312a7}{max\-\_\-adp\-\_\-xor3} that uses bounds. \-The reason is that at every bit position, \hyperlink{max-adp-xor3_8hh_ad2234c23808b10a3c3b64962c4d24198}{max\-\_\-adp\-\_\-xor3\-\_\-rec} (by \hyperlink{max-adp-xor3_8hh_a6033c1a639b25e76ffcecd62569fbd05}{max\-\_\-adp\-\_\-xor3\-\_\-rec\-\_\-i}) implicitly assumes that the remaining probability until the end (i.\-e. until the \-M\-S\-B) is 1, while the bounds computed by \hyperlink{max-adp-xor3_8hh_aa606808c54de33ad16170106454312a7}{max\-\_\-adp\-\_\-xor3} are tighter and thus more branches of the recursion are cut earlier in the computation.
\end{DoxyNote}
\-See also\-: \hyperlink{max-adp-xor3_8cc_ad25cee0908ad1bc426aae280885d7581}{max\-\_\-adp\-\_\-xor3\-\_\-i()} \hypertarget{max-adp-xor3_8cc_a6033c1a639b25e76ffcecd62569fbd05}{\index{max-\/adp-\/xor3.\-cc@{max-\/adp-\/xor3.\-cc}!max\-\_\-adp\-\_\-xor3\-\_\-rec\-\_\-i@{max\-\_\-adp\-\_\-xor3\-\_\-rec\-\_\-i}}
\index{max\-\_\-adp\-\_\-xor3\-\_\-rec\-\_\-i@{max\-\_\-adp\-\_\-xor3\-\_\-rec\-\_\-i}!max-adp-xor3.cc@{max-\/adp-\/xor3.\-cc}}
\paragraph[{max\-\_\-adp\-\_\-xor3\-\_\-rec\-\_\-i}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf max\-\_\-adp\-\_\-xor3\-\_\-rec\-\_\-i} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{k, }
\item[{const uint32\-\_\-t}]{n, }
\item[{double $\ast$}]{p, }
\item[{uint32\-\_\-t $\ast$}]{dd, }
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{gsl\-\_\-vector $\ast$}]{\-C, }
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{db, }
\item[{const uint32\-\_\-t}]{dc, }
\item[{uint32\-\_\-t $\ast$}]{dd\-\_\-max, }
\item[{double $\ast$}]{p\-\_\-max}
\end{DoxyParamCaption}
)}}\label{max-adp-xor3_8cc_a6033c1a639b25e76ffcecd62569fbd05}
\-Recursively compute the maximum differential probability over all output differences of the partial $(n-k)$-\/bit differential $\mathrm{max}_{dd}~\mathrm{adp}^{\oplus}(da[n-1:k],db[n-1:k],dc[n-1:k] \rightarrow dd[n-1:k])$.


\begin{DoxyParams}{\-Parameters}
{\em k} & current bit position\-: $ n > k \ge 0$. \\
\hline
{\em n} & word size. \\
\hline
{\em p} & the probability at bit position {\ttfamily k}. \\
\hline
{\em dd} & output difference. \\
\hline
{\em \-A} & transition probability matrices. \\
\hline
{\em \-C} & unit row vector initialized with 1 at the nitial state. \\
\hline
{\em da} & first input difference. \\
\hline
{\em db} & second input difference. \\
\hline
{\em dc} & third input difference. \\
\hline
{\em dd\-\_\-max} & maximum probability output difference. \\
\hline
{\em p\-\_\-max} & the maximum probability.\\
\hline
\end{DoxyParams}
{\bfseries \-Algorithm} {\bfseries \-Outline\-:} 

\-The function recursively assigns the bits of the output difference starting at the \-L\-S bit position $k = 0$ and proceeding to $k+1$ only if the probability so far is still above the maximum that was found up to now. \-The initial value for the maximum probability {\ttfamily p\-\_\-max} is 0 and is updated dynamically during the process every time a higher probability is encountered. \-The recursion stops at the \-M\-S\-B $k = n$.

\-See also\-: \hyperlink{max-adp-xor3_8cc_ad2234c23808b10a3c3b64962c4d24198}{max\-\_\-adp\-\_\-xor3\-\_\-rec()} 
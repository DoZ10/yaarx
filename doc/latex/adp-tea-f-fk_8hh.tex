\hypertarget{adp-tea-f-fk_8hh}{\subsection{include/adp-\/tea-\/f-\/fk.hh \-File \-Reference}
\label{adp-tea-f-fk_8hh}\index{include/adp-\/tea-\/f-\/fk.\-hh@{include/adp-\/tea-\/f-\/fk.\-hh}}
}


\-Header file for \hyperlink{adp-tea-f-fk_8cc}{adp-\/tea-\/f-\/fk.\-cc}\-: \-The \-A\-D\-D differential probability of the \-F-\/function of \-T\-E\-A for a fixed key and round constants $\mathrm{adp}^{F}(k_0, k_1, \delta |~ da \rightarrow dd)$, where $ F(k_0, k_1, \delta |~ x) = ((x \ll 4) + k_0) \oplus (x + \delta) \oplus ((x \gg 5) + k_1)$ \-Complexity\-: $ O(n) < c \le O(2^n) $. .  


\subsubsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{adp-tea-f-fk_8hh_a0f6202112f8d6e5030468311d4dfe5b0}{adp\-\_\-f\-\_\-check\-\_\-x} (const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t dx, const uint32\-\_\-t dy, const uint32\-\_\-t x)
\item 
bool \hyperlink{adp-tea-f-fk_8hh_a08aeb7cc83aaf6bd1f9a3758f45112b4}{adp\-\_\-f\-\_\-is\-\_\-sat} (const uint32\-\_\-t mask\-\_\-i, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t dx, const uint32\-\_\-t dy, int32\-\_\-t x)
\item 
uint32\-\_\-t \hyperlink{adp-tea-f-fk_8hh_aeaf46be11e7c500a368d08cf6f32acb6}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x} (const uint32\-\_\-t n, const uint32\-\_\-t i, const uint32\-\_\-t mask\-\_\-i, const uint32\-\_\-t x, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t dx, const uint32\-\_\-t dy, uint32\-\_\-t $\ast$x\-\_\-cnt, double $\ast$prob)
\item 
double \hyperlink{adp-tea-f-fk_8hh_a197140aa874649bb8dc119db47f6b139}{adp\-\_\-f\-\_\-fk} (const uint32\-\_\-t n, const uint32\-\_\-t dx, const uint32\-\_\-t dy, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const)
\item 
uint32\-\_\-t \hyperlink{adp-tea-f-fk_8hh_aa85b9197280f9256f76aac08b5e2ea0c}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx} (const uint32\-\_\-t n, const uint32\-\_\-t i, const uint32\-\_\-t mask\-\_\-i, const uint32\-\_\-t x, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t dx, const uint32\-\_\-t dy, uint64\-\_\-t $\ast$x\-\_\-cnt, double $\ast$ret\-\_\-prob, uint32\-\_\-t $\ast$ret\-\_\-dx)
\item 
double \hyperlink{adp-tea-f-fk_8hh_a51a32e1be5232b4b96d539b64171009a}{max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk} (const uint32\-\_\-t n, uint32\-\_\-t $\ast$ret\-\_\-dx, const uint32\-\_\-t dy, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const)
\item 
uint32\-\_\-t \hyperlink{adp-tea-f-fk_8hh_aae562be508050d9e6ecdae77897a1133}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy} (const uint32\-\_\-t n, const uint32\-\_\-t i, const uint32\-\_\-t mask\-\_\-i, const uint32\-\_\-t x, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t dx, const uint32\-\_\-t dy, uint64\-\_\-t $\ast$x\-\_\-cnt, double $\ast$ret\-\_\-prob, uint32\-\_\-t $\ast$ret\-\_\-dy)
\item 
double \hyperlink{adp-tea-f-fk_8hh_a2f54b400bfcf7269993eb54751c072fb}{max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk} (const uint32\-\_\-t n, const uint32\-\_\-t dx, uint32\-\_\-t $\ast$ret\-\_\-dy, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const)
\item 
double \hyperlink{adp-tea-f-fk_8hh_addb1c3108db9d2478da5e46e645ba86b}{all\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk} (const uint32\-\_\-t n, const uint32\-\_\-t dx, uint32\-\_\-t $\ast$ret\-\_\-dy, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const, uint64\-\_\-t $\ast$x\-\_\-cnt)
\item 
uint32\-\_\-t \hyperlink{adp-tea-f-fk_8hh_a1fbc1386595fdbbdee8d7b8f19a17d5e}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-dy} (const uint32\-\_\-t n, const uint32\-\_\-t i, const uint32\-\_\-t mask\-\_\-i, const uint32\-\_\-t x, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t dx, const uint32\-\_\-t dy, \hyperlink{structdifferential__t}{differential\-\_\-t} $\ast$x\-\_\-cnt, double $\ast$ret\-\_\-prob, uint32\-\_\-t $\ast$ret\-\_\-dx, uint32\-\_\-t $\ast$ret\-\_\-dy)
\item 
double \hyperlink{adp-tea-f-fk_8hh_a2df7ed20567ef6e3c054e2acd67bf267}{max\-\_\-dx\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk} (const uint32\-\_\-t n, uint32\-\_\-t $\ast$ret\-\_\-dx, uint32\-\_\-t $\ast$ret\-\_\-dy, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const)
\item 
uint32\-\_\-t \hyperlink{adp-tea-f-fk_8hh_af150550e5c149d5ded3b70aff98e6bd6}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-key} (const uint32\-\_\-t n, const uint32\-\_\-t i, const uint32\-\_\-t mask\-\_\-i, const uint32\-\_\-t x, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t dx, const uint32\-\_\-t dy, uint64\-\_\-t $\ast$$\ast$$\ast$x\-\_\-cnt, double $\ast$ret\-\_\-prob, uint32\-\_\-t $\ast$ret\-\_\-dx, uint32\-\_\-t $\ast$ret\-\_\-k0, uint32\-\_\-t $\ast$ret\-\_\-k1)
\item 
double \hyperlink{adp-tea-f-fk_8hh_ad6c768555117904c05a4a4b6b289f5c0}{max\-\_\-key\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk} (const uint32\-\_\-t n, uint32\-\_\-t $\ast$ret\-\_\-dx, const uint32\-\_\-t dy, uint32\-\_\-t $\ast$ret\-\_\-k0, uint32\-\_\-t $\ast$ret\-\_\-k1, const uint32\-\_\-t delta, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const)
\item 
double \hyperlink{adp-tea-f-fk_8hh_a0eb20434ffabc8e299f69786b8ff6a43}{adp\-\_\-f\-\_\-fk\-\_\-v2} (const uint32\-\_\-t da, const uint32\-\_\-t dd, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const)
\item 
void \hyperlink{adp-tea-f-fk_8hh_aec0b210e6e32237337038b416e4566d1}{f\-\_\-sfun} (const uint32\-\_\-t n, const uint32\-\_\-t x\-\_\-word, const uint32\-\_\-t dx\-\_\-word, const uint32\-\_\-t delta\-\_\-word, const uint32\-\_\-t k0\-\_\-word, const uint32\-\_\-t k1\-\_\-word)
\item 
double \hyperlink{adp-tea-f-fk_8hh_a32817c473c18fcb887021664b22afca5}{adp\-\_\-f\-\_\-fk\-\_\-exper} (const uint32\-\_\-t da, const uint32\-\_\-t db, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, uint32\-\_\-t lsh\-\_\-const, uint32\-\_\-t rsh\-\_\-const)
\item 
double \hyperlink{adp-tea-f-fk_8hh_ab86a96e9a2cd0282189dd994003e201e}{max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper} (uint32\-\_\-t $\ast$max\-\_\-dx, const uint32\-\_\-t dy, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, uint32\-\_\-t lsh\-\_\-const, uint32\-\_\-t rsh\-\_\-const)
\item 
double \hyperlink{adp-tea-f-fk_8hh_a299291aea5364cebb5c98d48d46aa169}{max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper} (const uint32\-\_\-t dx, uint32\-\_\-t $\ast$max\-\_\-dy, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, uint32\-\_\-t lsh\-\_\-const, uint32\-\_\-t rsh\-\_\-const)
\item 
double \hyperlink{adp-tea-f-fk_8hh_af1d9960648819fb29344f13ed7e58611}{max\-\_\-dx\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper} (uint32\-\_\-t $\ast$max\-\_\-dx, uint32\-\_\-t $\ast$max\-\_\-dy, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, uint32\-\_\-t lsh\-\_\-const, uint32\-\_\-t rsh\-\_\-const)
\item 
uint64\-\_\-t $\ast$$\ast$$\ast$ \hyperlink{adp-tea-f-fk_8hh_ab4e509bba222c76d59129ff86d32a045}{x\-\_\-cnt\-\_\-alloc} ()
\item 
void \hyperlink{adp-tea-f-fk_8hh_a0f892e305090fbfd0ff4572ba6930496}{x\-\_\-cnt\-\_\-free} (uint64\-\_\-t $\ast$$\ast$$\ast$x\-\_\-cnt)
\item 
void \hyperlink{adp-tea-f-fk_8hh_a41169fd6ba69f9384b6274c597b473bf}{x\-\_\-cnt\-\_\-print} (uint32\-\_\-t $\ast$$\ast$$\ast$x\-\_\-cnt)
\end{DoxyCompactItemize}


\subsubsection{\-Detailed \-Description}
\-Header file for \hyperlink{adp-tea-f-fk_8cc}{adp-\/tea-\/f-\/fk.\-cc}\-: \-The \-A\-D\-D differential probability of the \-F-\/function of \-T\-E\-A for a fixed key and round constants $\mathrm{adp}^{F}(k_0, k_1, \delta |~ da \rightarrow dd)$, where $ F(k_0, k_1, \delta |~ x) = ((x \ll 4) + k_0) \oplus (x + \delta) \oplus ((x \gg 5) + k_1)$ \-Complexity\-: $ O(n) < c \le O(2^n) $. . \begin{DoxyAuthor}{\-Author}
\-V.\-Velichkov, \href{mailto:vesselin.velichkov@uni.lu}{\tt vesselin.\-velichkov@uni.\-lu} 
\end{DoxyAuthor}
\begin{DoxyDate}{\-Date}
2012-\/2013 
\end{DoxyDate}


\subsubsection{\-Function \-Documentation}
\hypertarget{adp-tea-f-fk_8hh_aeaf46be11e7c500a368d08cf6f32acb6}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x@{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x}}
\index{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x@{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t {\bf adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{const uint32\-\_\-t}]{i, }
\item[{const uint32\-\_\-t}]{mask\-\_\-i, }
\item[{const uint32\-\_\-t}]{x, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{uint32\-\_\-t $\ast$}]{x\-\_\-cnt, }
\item[{double $\ast$}]{prob}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_aeaf46be11e7c500a368d08cf6f32acb6}
\-Counts the number of values {\ttfamily x} for which the differential $(dx \rightarrow dy)$ for the \-F-\/function of \-T\-E\-A is satisfied. \-The function operates by recursively assigning the bits of {\ttfamily x} starting from bit position {\ttfamily i} and terminating at the \-M\-S bit {\ttfamily n}. \-The recursion proceeds to bit $(i+1)$ only if the differential is satisfied on the {\ttfamily i} \-L\-S bits. \-This is checked by applying \hyperlink{adp-tea-f-fk_8hh_a08aeb7cc83aaf6bd1f9a3758f45112b4}{adp\-\_\-f\-\_\-is\-\_\-sat}.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size (terminating bit popsition). \\
\hline
{\em i} & current bit position. \\
\hline
{\em mask\-\_\-i} & mask on the {\ttfamily i} \-L\-S bits of {\ttfamily x}. \\
\hline
{\em x} & input value of size at least ({\ttfamily i} + {\ttfamily rsh\-\_\-const}). \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em dx} & input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em x\-\_\-cnt} & number of values satisfying $(dx \rightarrow dy)$. \\
\hline
{\em prob} & the fixed-\/key \-A\-D\-D probability of {\ttfamily \-F\-:} $\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
{\ttfamily 1} if $x[i-1:0]$ satisfies $(dx[i-1:0] \rightarrow dy[i-1:0])$; {\ttfamily 0} otherwise. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_a197140aa874649bb8dc119db47f6b139}{adp\-\_\-f\-\_\-fk} 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_aa85b9197280f9256f76aac08b5e2ea0c}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx@{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx}}
\index{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx@{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t {\bf adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{const uint32\-\_\-t}]{i, }
\item[{const uint32\-\_\-t}]{mask\-\_\-i, }
\item[{const uint32\-\_\-t}]{x, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{uint64\-\_\-t $\ast$}]{x\-\_\-cnt, }
\item[{double $\ast$}]{ret\-\_\-prob, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dx}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_aa85b9197280f9256f76aac08b5e2ea0c}
\-For given output difference {\ttfamily dy}, compute all input differences {\ttfamily dx} and their probabilities, by counting all values {\ttfamily x} that satisfy the differential $(dx \rightarrow dy)$ for a fixed key and round constant. \-At the same time keeps track of the maximum probability input difference.

\-The function works by recursively assigning the bits of {\ttfamily x} and {\ttfamily dx} starting at bit position {\ttfamily i} and terminating at the \-M\-S bit {\ttfamily n}. \-The recursion proceeds to bit $(i+1)$ only if the differential is satisfied on the {\ttfamily i} \-L\-S bits. \-This is checked by applying \hyperlink{adp-tea-f-fk_8hh_a08aeb7cc83aaf6bd1f9a3758f45112b4}{adp\-\_\-f\-\_\-is\-\_\-sat} .


\begin{DoxyParams}{\-Parameters}
{\em n} & word size (terminating bit popsition). \\
\hline
{\em i} & current bit position. \\
\hline
{\em mask\-\_\-i} & mask on the {\ttfamily i} \-L\-S bits of {\ttfamily x}. \\
\hline
{\em x} & input value of size at least ({\ttfamily i} + {\ttfamily rsh\-\_\-const}). \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em dx} & input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em x\-\_\-cnt} & array of $2^n$ counters -\/ each one keeps track of the number of values satisfying $(dx \rightarrow dy)$ for every {\ttfamily dx}. \\
\hline
{\em ret\-\_\-prob} & the maximum probability over all input differences $\mathrm{max}_{dx} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. \\
\hline
{\em ret\-\_\-dx} & the input difference that has maximum probability. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
{\ttfamily 1} if $x[i-1:0]$ satisfies $(dx[i-1:0] \rightarrow dy[i-1:0])$; {\ttfamily 0} otherwise.
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_aeaf46be11e7c500a368d08cf6f32acb6}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x}, \hyperlink{adp-tea-f-fk_8hh_a51a32e1be5232b4b96d539b64171009a}{max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk} 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_a1fbc1386595fdbbdee8d7b8f19a17d5e}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-dy@{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-dy}}
\index{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-dy@{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-dy}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-dy}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t {\bf adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-dy} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{const uint32\-\_\-t}]{i, }
\item[{const uint32\-\_\-t}]{mask\-\_\-i, }
\item[{const uint32\-\_\-t}]{x, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{{\bf differential\-\_\-t} $\ast$}]{x\-\_\-cnt, }
\item[{double $\ast$}]{ret\-\_\-prob, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dx, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dy}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_a1fbc1386595fdbbdee8d7b8f19a17d5e}
\-For the \-T\-E\-A \-F-\/functuion with fixed key and round constant, compute all differentials $(dx \rightarrow dy)$ and their probabilities.

\-The function works by recursively assigning the bits of {\ttfamily x}, {\ttfamily dx} and {\ttfamily dy} starting at bit position {\ttfamily i} and terminating at the \-M\-S bit {\ttfamily n}. \-The recursion proceeds to bit $(i+1)$ only if the differential is satisfied on the {\ttfamily i} \-L\-S bits. \-This is checked by applying \hyperlink{adp-tea-f-fk_8hh_a08aeb7cc83aaf6bd1f9a3758f45112b4}{adp\-\_\-f\-\_\-is\-\_\-sat}.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size (terminating bit popsition). \\
\hline
{\em i} & current bit position. \\
\hline
{\em mask\-\_\-i} & mask on the {\ttfamily i} \-L\-S bits of {\ttfamily x}. \\
\hline
{\em x} & input value of size at least ({\ttfamily i} + {\ttfamily rsh\-\_\-const}). \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em dx} & input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em x\-\_\-cnt} & array of $2^{2n}$ differentials $(dx \rightarrow dy)$ and their probabilities. \\
\hline
{\em ret\-\_\-prob} & the maximum probability over all input and output differences $\mathrm{max}_{dy,dy} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. \\
\hline
{\em ret\-\_\-dx} & the input difference of the maximum probability differential. \\
\hline
{\em ret\-\_\-dy} & the output difference of the maximum probability differential. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
{\ttfamily 1} if $x[i-1:0]$ satisfies $(dx[i-1:0] \rightarrow dy[i-1:0])$; {\ttfamily 0} otherwise.
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_aa85b9197280f9256f76aac08b5e2ea0c}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx}, \hyperlink{adp-tea-f-fk_8hh_aae562be508050d9e6ecdae77897a1133}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy}. 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_af150550e5c149d5ded3b70aff98e6bd6}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-key@{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-key}}
\index{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-key@{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-key}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-key}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t {\bf adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-key} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{const uint32\-\_\-t}]{i, }
\item[{const uint32\-\_\-t}]{mask\-\_\-i, }
\item[{const uint32\-\_\-t}]{x, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{uint64\-\_\-t $\ast$$\ast$$\ast$}]{x\-\_\-cnt, }
\item[{double $\ast$}]{ret\-\_\-prob, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dx, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-k0, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-k1}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_af150550e5c149d5ded3b70aff98e6bd6}
\-For the \-T\-E\-A \-F-\/function with fixed round constant, and for a fixed output difference {\ttfamily dy}, compute all differentials $(dx \rightarrow dy)$ and their probabilities for all values of the round keys {\ttfamily k0}, {\ttfamily k1}.

\-The function works by recursively assigning the bits of {\ttfamily x}, {\ttfamily dx}, {\ttfamily k0} and {\ttfamily k1} starting at bit position {\ttfamily i} and terminating at the \-M\-S bit {\ttfamily n}. \-The recursion proceeds to bit $(i+1)$ only if the differential is satisfied on the {\ttfamily i} \-L\-S bits. \-This is checked by applying \hyperlink{adp-tea-f-fk_8hh_a08aeb7cc83aaf6bd1f9a3758f45112b4}{adp\-\_\-f\-\_\-is\-\_\-sat}.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size (terminating bit popsition). \\
\hline
{\em i} & current bit position. \\
\hline
{\em mask\-\_\-i} & mask on the {\ttfamily i} \-L\-S bits of {\ttfamily x}. \\
\hline
{\em x} & input value of size at least ({\ttfamily i} + {\ttfamily rsh\-\_\-const}). \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em dx} & input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em x\-\_\-cnt} & array of $2^{3n}$ differentials $(dx \rightarrow dy)$ and their probabilities. \\
\hline
{\em ret\-\_\-prob} & the maximum probability over all input differences and round keys $\mathrm{max}_{dx,k_0,k_1} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. \\
\hline
{\em ret\-\_\-dx} & the input difference of the maximum probability differential. \\
\hline
{\em ret\-\_\-k0} & the first round key for the maximum probability differential. \\
\hline
{\em ret\-\_\-k1} & the second round key for the maximum probability differential. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
{\ttfamily 1} if $x[i-1:0]$ satisfies $(dx[i-1:0] \rightarrow dy[i-1:0])$; {\ttfamily 0} otherwise.
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_af150550e5c149d5ded3b70aff98e6bd6}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-key}, \hyperlink{adp-tea-f-fk_8hh_a1fbc1386595fdbbdee8d7b8f19a17d5e}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-dy}. 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_aae562be508050d9e6ecdae77897a1133}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy@{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy}}
\index{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy@{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t {\bf adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{const uint32\-\_\-t}]{i, }
\item[{const uint32\-\_\-t}]{mask\-\_\-i, }
\item[{const uint32\-\_\-t}]{x, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{uint64\-\_\-t $\ast$}]{x\-\_\-cnt, }
\item[{double $\ast$}]{ret\-\_\-prob, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dy}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_aae562be508050d9e6ecdae77897a1133}
\-For given input difference {\ttfamily dx}, compute all output differences {\ttfamily dy} and their probabilities, by counting all values {\ttfamily x} that satisfy the differential $(dx \rightarrow dy)$ for a fixed key and round constant. \-At the same time keeps track of the maximum probability output difference.

\-The function works by recursively assigning the bits of {\ttfamily x} and {\ttfamily dy} starting at bit position {\ttfamily i} and terminating at the \-M\-S bit {\ttfamily n}. \-The recursion proceeds to bit $(i+1)$ only if the differential is satisfied on the {\ttfamily i} \-L\-S bits. \-This is checked by applying \hyperlink{adp-tea-f-fk_8hh_a08aeb7cc83aaf6bd1f9a3758f45112b4}{adp\-\_\-f\-\_\-is\-\_\-sat}.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size (terminating bit popsition). \\
\hline
{\em i} & current bit position. \\
\hline
{\em mask\-\_\-i} & mask on the {\ttfamily i} \-L\-S bits of {\ttfamily x}. \\
\hline
{\em x} & input value of size at least ({\ttfamily i} + {\ttfamily rsh\-\_\-const}). \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em dx} & input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em x\-\_\-cnt} & array of $2^n$ counters -\/ each one keeps track of the number of values satisfying $(dx \rightarrow dy)$ for every {\ttfamily dy}. \\
\hline
{\em ret\-\_\-prob} & the maximum probability over all output differences $\mathrm{max}_{dy} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. \\
\hline
{\em ret\-\_\-dy} & the output difference that has maximum probability. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
{\ttfamily 1} if $x[i-1:0]$ satisfies $(dx[i-1:0] \rightarrow dy[i-1:0])$; {\ttfamily 0} otherwise.
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_aa85b9197280f9256f76aac08b5e2ea0c}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx} 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_a0f6202112f8d6e5030468311d4dfe5b0}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!adp\-\_\-f\-\_\-check\-\_\-x@{adp\-\_\-f\-\_\-check\-\_\-x}}
\index{adp\-\_\-f\-\_\-check\-\_\-x@{adp\-\_\-f\-\_\-check\-\_\-x}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{adp\-\_\-f\-\_\-check\-\_\-x}]{\setlength{\rightskip}{0pt plus 5cm}bool {\bf adp\-\_\-f\-\_\-check\-\_\-x} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{const uint32\-\_\-t}]{x}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_a0f6202112f8d6e5030468311d4dfe5b0}
\-Check if a given value {\ttfamily x} satisfies the \-A\-D\-D differential $(dx \rightarrow dy)$ for the \-T\-E\-A \-F-\/function.


\begin{DoxyParams}{\-Parameters}
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em dx} & input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em x} & input value. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-T\-R\-U\-E if $k_0, k_1, \delta:~ dy = F(x + dx) - F(x)$. 
\end{DoxyReturn}
\hypertarget{adp-tea-f-fk_8hh_a197140aa874649bb8dc119db47f6b139}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!adp\-\_\-f\-\_\-fk@{adp\-\_\-f\-\_\-fk}}
\index{adp\-\_\-f\-\_\-fk@{adp\-\_\-f\-\_\-fk}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{adp\-\_\-f\-\_\-fk}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf adp\-\_\-f\-\_\-fk} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_a197140aa874649bb8dc119db47f6b139}
\-Compute the fixed-\/key, fixed-\/constant \-A\-D\-D differential probability of the \-F-\/function of block cipher \-T\-E\-A\-: $\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. {\bfseries \-Complexity\-:} $ O(n) < c \le O(2^n) $.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size. \\
\hline
{\em dx} & input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_aeaf46be11e7c500a368d08cf6f32acb6}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x} 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_a32817c473c18fcb887021664b22afca5}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!adp\-\_\-f\-\_\-fk\-\_\-exper@{adp\-\_\-f\-\_\-fk\-\_\-exper}}
\index{adp\-\_\-f\-\_\-fk\-\_\-exper@{adp\-\_\-f\-\_\-fk\-\_\-exper}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{adp\-\_\-f\-\_\-fk\-\_\-exper}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf adp\-\_\-f\-\_\-fk\-\_\-exper} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{db, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_a32817c473c18fcb887021664b22afca5}
\-Compute the fixed-\/key, fixed-\/constant \-A\-D\-D differential probability of the \-F-\/function of block cipher \-T\-E\-A\-: $\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$ through exhaustive search over all input values. {\bfseries \-Complexity\-:} $O(2^n)$.


\begin{DoxyParams}{\-Parameters}
{\em da} & input difference. \\
\hline
{\em db} & output difference. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_a197140aa874649bb8dc119db47f6b139}{adp\-\_\-f\-\_\-fk}, \hyperlink{adp-tea-f-fk_8hh_a0eb20434ffabc8e299f69786b8ff6a43}{adp\-\_\-f\-\_\-fk\-\_\-v2}. 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_a0eb20434ffabc8e299f69786b8ff6a43}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!adp\-\_\-f\-\_\-fk\-\_\-v2@{adp\-\_\-f\-\_\-fk\-\_\-v2}}
\index{adp\-\_\-f\-\_\-fk\-\_\-v2@{adp\-\_\-f\-\_\-fk\-\_\-v2}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{adp\-\_\-f\-\_\-fk\-\_\-v2}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf adp\-\_\-f\-\_\-fk\-\_\-v2} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{dd, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_a0eb20434ffabc8e299f69786b8ff6a43}
\-Compute the fixed-\/key, fixed-\/constant \-A\-D\-D differential probability of the \-F-\/function of block cipher \-T\-E\-A\-: $\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$.

\-The function works by dividing the input to \-F into independent parts and iterating over the values in each part. \-The resulting complexity is equivalent to exhaustive search over all inputs\-: $O(2^n)$.


\begin{DoxyParams}{\-Parameters}
{\em da} & input difference. \\
\hline
{\em dd} & output difference. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_a197140aa874649bb8dc119db47f6b139}{adp\-\_\-f\-\_\-fk} 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_a08aeb7cc83aaf6bd1f9a3758f45112b4}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!adp\-\_\-f\-\_\-is\-\_\-sat@{adp\-\_\-f\-\_\-is\-\_\-sat}}
\index{adp\-\_\-f\-\_\-is\-\_\-sat@{adp\-\_\-f\-\_\-is\-\_\-sat}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{adp\-\_\-f\-\_\-is\-\_\-sat}]{\setlength{\rightskip}{0pt plus 5cm}bool {\bf adp\-\_\-f\-\_\-is\-\_\-sat} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{mask\-\_\-i, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{int32\-\_\-t}]{x}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_a08aeb7cc83aaf6bd1f9a3758f45112b4}
\-Check if the differential $(dx \rightarrow dy)$ for {\ttfamily \-F} is satisfied on the {\ttfamily i} \-L\-S bits of {\ttfamily x} i.\-e. check if $k_0, k_1, \delta:~ dy[i-1:0] = F(x[i-1:0] + dx[i-1:0]) - F(x[i-1:0]) ~\mathrm{mod} ~2^{i}$.

\begin{DoxyAttention}{\-Attention}
{\ttfamily x} must be of size at least $(i + R)$ bits where {\ttfamily \-R} is the \-R\-S\-H constant of {\ttfamily \-F}.
\end{DoxyAttention}

\begin{DoxyParams}{\-Parameters}
{\em mask\-\_\-i} & {\ttfamily i} bit mask. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em dx} & input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em x} & input value of size at least ({\ttfamily i} + {\ttfamily rsh\-\_\-const}). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-T\-R\-U\-E if $k_0, k_1, \delta:~ dy[i-1:0] = F(x[i-1:0] + dx[i-1:0]) - F(x[i-1:0]) ~\mathrm{mod} ~2^{i}$. 
\end{DoxyReturn}
\hypertarget{adp-tea-f-fk_8hh_addb1c3108db9d2478da5e46e645ba86b}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!all\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk@{all\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk}}
\index{all\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk@{all\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{all\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf all\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dy, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{uint64\-\_\-t $\ast$}]{x\-\_\-cnt}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_addb1c3108db9d2478da5e46e645ba86b}
\-For given input difference {\ttfamily dx}, compute all output differences {\ttfamily dy} for the \-T\-E\-A \-F-\/function with fixed keys and round constants. \-Returns the maximum output probability.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size. \\
\hline
{\em dx} & input difference. \\
\hline
{\em ret\-\_\-dy} & maximum probability output difference. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
{\em x\-\_\-cnt} & array of $2^n$ counters -\/ each one keeps track of the number of inputs {\ttfamily x} satisfying $(dx \rightarrow dy)$ for every {\ttfamily dy}. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dy} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_a2f54b400bfcf7269993eb54751c072fb}{max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk} 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_aec0b210e6e32237337038b416e4566d1}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!f\-\_\-sfun@{f\-\_\-sfun}}
\index{f\-\_\-sfun@{f\-\_\-sfun}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{f\-\_\-sfun}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf f\-\_\-sfun} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{const uint32\-\_\-t}]{x\-\_\-word, }
\item[{const uint32\-\_\-t}]{dx\-\_\-word, }
\item[{const uint32\-\_\-t}]{delta\-\_\-word, }
\item[{const uint32\-\_\-t}]{k0\-\_\-word, }
\item[{const uint32\-\_\-t}]{k1\-\_\-word}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_aec0b210e6e32237337038b416e4566d1}
\-Compute the \-S-\/function for the \-T\-E\-A \-F function.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size. \\
\hline
{\em x\-\_\-word} & input to \-F. \\
\hline
{\em dx\-\_\-word} & input difference. \\
\hline
{\em delta\-\_\-word} & round constant. \\
\hline
{\em k0\-\_\-word} & first round key. \\
\hline
{\em k1\-\_\-word} & second round key. \\
\hline
\end{DoxyParams}
\hypertarget{adp-tea-f-fk_8hh_a51a32e1be5232b4b96d539b64171009a}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk@{max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk}}
\index{max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk@{max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_a51a32e1be5232b4b96d539b64171009a}
\-For given output difference {\ttfamily dy}, compute the maximum probability input differences {\ttfamily dx} over all input differences\-: $\mathrm{max}_{dx} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. {\bfseries \-Complexity\-:} $ O(2n) < c \le O(2^{2n}) $. {\bfseries \-Memory\-:} $4 \cdot 2^n$ \-Bytes.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size. \\
\hline
{\em ret\-\_\-dx} & maximum probability input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dx} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_aa85b9197280f9256f76aac08b5e2ea0c}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx} 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_ab86a96e9a2cd0282189dd994003e201e}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper@{max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper}}
\index{max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper@{max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper} (
\begin{DoxyParamCaption}
\item[{uint32\-\_\-t $\ast$}]{max\-\_\-dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_ab86a96e9a2cd0282189dd994003e201e}
\-For given output difference {\ttfamily dy}, compute the maximum probability input differences {\ttfamily dx} over all input differences\-: $\mathrm{max}_{dx} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$ through exhaustive search over all input values and input differences. {\bfseries \-Complexity\-:} $O(2^{2n})$.


\begin{DoxyParams}{\-Parameters}
{\em max\-\_\-dx} & maximum probability input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dx} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_a51a32e1be5232b4b96d539b64171009a}{max\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk} 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_a2df7ed20567ef6e3c054e2acd67bf267}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!max\-\_\-dx\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk@{max\-\_\-dx\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk}}
\index{max\-\_\-dx\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk@{max\-\_\-dx\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{max\-\_\-dx\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-dx\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dx, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dy, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_a2df7ed20567ef6e3c054e2acd67bf267}
\-For the \-T\-E\-A \-F-\/functuion with fixed key and round constant, compute the maximum probability differential $(dx \rightarrow dy)$ over all input and output differences. {\bfseries \-Complexity\-:} $ O(3n) < c \le O(2^{3n}) $. {\bfseries \-Memory\-:} $12 \cdot 2^{2n}$ \-Bytes.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size. \\
\hline
{\em ret\-\_\-dx} & the input difference of the maximum probability differential. \\
\hline
{\em ret\-\_\-dy} & the output difference of the maximum probability differential. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dx,dy} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_a1fbc1386595fdbbdee8d7b8f19a17d5e}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-dy} 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_af1d9960648819fb29344f13ed7e58611}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!max\-\_\-dx\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper@{max\-\_\-dx\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper}}
\index{max\-\_\-dx\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper@{max\-\_\-dx\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{max\-\_\-dx\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-dx\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper} (
\begin{DoxyParamCaption}
\item[{uint32\-\_\-t $\ast$}]{max\-\_\-dx, }
\item[{uint32\-\_\-t $\ast$}]{max\-\_\-dy, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_af1d9960648819fb29344f13ed7e58611}
\-For the \-T\-E\-A \-F-\/functuion with fixed key and round constant, compute the maximum probability differential $(dx \rightarrow dy)$ over all input and output differences. {\bfseries \-Complexity\-:} $O(2^{3n})$.


\begin{DoxyParams}{\-Parameters}
{\em max\-\_\-dx} & the input difference of the maximum probability differential. \\
\hline
{\em max\-\_\-dy} & the output difference of the maximum probability differential. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dx,dy} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_a2df7ed20567ef6e3c054e2acd67bf267}{max\-\_\-dx\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk} 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_a2f54b400bfcf7269993eb54751c072fb}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk@{max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk}}
\index{max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk@{max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dy, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_a2f54b400bfcf7269993eb54751c072fb}
\-For given input difference {\ttfamily dx}, compute the maximum probability output difference {\ttfamily dy} over all output differences\-: $\mathrm{max}_{dy} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. {\bfseries \-Complexity\-:} $ O(2n) < c \le O(2^{2n}) $. {\bfseries \-Memory} {\bfseries requirement\-:} $4 \cdot 2^n$ \-Bytes.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size. \\
\hline
{\em dx} & input difference. \\
\hline
{\em ret\-\_\-dy} & maximum probability output difference. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dy} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_aae562be508050d9e6ecdae77897a1133}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy}, \hyperlink{adp-tea-f-fk_8hh_a2f54b400bfcf7269993eb54751c072fb}{max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk} 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_a299291aea5364cebb5c98d48d46aa169}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper@{max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper}}
\index{max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper@{max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk\-\_\-exper} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{dx, }
\item[{uint32\-\_\-t $\ast$}]{max\-\_\-dy, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_a299291aea5364cebb5c98d48d46aa169}
\-For given input difference {\ttfamily dx}, compute the maximum probability output difference {\ttfamily dy} over all output differences\-: $\mathrm{max}_{dy} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$ through exhaustive search over all input values and input differences. {\bfseries \-Complexity\-:} $O(2^{2n})$.


\begin{DoxyParams}{\-Parameters}
{\em dx} & input difference. \\
\hline
{\em max\-\_\-dy} & maximum probability output difference. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dx} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_a2f54b400bfcf7269993eb54751c072fb}{max\-\_\-dy\-\_\-adp\-\_\-f\-\_\-fk} 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_ad6c768555117904c05a4a4b6b289f5c0}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!max\-\_\-key\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk@{max\-\_\-key\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk}}
\index{max\-\_\-key\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk@{max\-\_\-key\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{max\-\_\-key\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-key\-\_\-dx\-\_\-adp\-\_\-f\-\_\-fk} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-k0, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_ad6c768555117904c05a4a4b6b289f5c0}
\-For the \-T\-E\-A \-F-\/functuion with fixed key and round constant, compute the maximum probability differential $(dx \rightarrow dy)$ over all input differences and round keys. {\bfseries \-Complexity\-:} $ O(4n) < c \le O(2^{4n}) $. {\bfseries \-Memory\-:} $12 \cdot 2^{3n}$ \-Bytes.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size. \\
\hline
{\em dy} & output difference. \\
\hline
{\em ret\-\_\-dx} & the input difference of the maximum probability differential. \\
\hline
{\em ret\-\_\-k0} & the first round key for the maximum probability differential. \\
\hline
{\em ret\-\_\-k1} & the second round key for the maximum probability differential. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dx,k_0,k_1} ~\mathrm{adp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_af150550e5c149d5ded3b70aff98e6bd6}{adp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx\-\_\-key} 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_ab4e509bba222c76d59129ff86d32a045}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!x\-\_\-cnt\-\_\-alloc@{x\-\_\-cnt\-\_\-alloc}}
\index{x\-\_\-cnt\-\_\-alloc@{x\-\_\-cnt\-\_\-alloc}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{x\-\_\-cnt\-\_\-alloc}]{\setlength{\rightskip}{0pt plus 5cm}uint64\-\_\-t$\ast$$\ast$$\ast$ {\bf x\-\_\-cnt\-\_\-alloc} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_ab4e509bba222c76d59129ff86d32a045}
\-Allocate memory for a 2\-D array of differentials. \begin{DoxyReturn}{\-Returns}
2\-D array of differentials. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_a0f892e305090fbfd0ff4572ba6930496}{x\-\_\-cnt\-\_\-free} 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_a0f892e305090fbfd0ff4572ba6930496}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!x\-\_\-cnt\-\_\-free@{x\-\_\-cnt\-\_\-free}}
\index{x\-\_\-cnt\-\_\-free@{x\-\_\-cnt\-\_\-free}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{x\-\_\-cnt\-\_\-free}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf x\-\_\-cnt\-\_\-free} (
\begin{DoxyParamCaption}
\item[{uint64\-\_\-t $\ast$$\ast$$\ast$}]{x\-\_\-cnt}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_a0f892e305090fbfd0ff4572ba6930496}
\-Free the memory allocated from a previous call to \hyperlink{adp-tea-f-fk_8hh_ab4e509bba222c76d59129ff86d32a045}{x\-\_\-cnt\-\_\-alloc} 
\begin{DoxyParams}{\-Parameters}
{\em x\-\_\-cnt} & 2\-D array of differentials. \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-tea-f-fk_8hh_ab4e509bba222c76d59129ff86d32a045}{x\-\_\-cnt\-\_\-alloc} 
\end{DoxySeeAlso}
\hypertarget{adp-tea-f-fk_8hh_a41169fd6ba69f9384b6274c597b473bf}{\index{adp-\/tea-\/f-\/fk.\-hh@{adp-\/tea-\/f-\/fk.\-hh}!x\-\_\-cnt\-\_\-print@{x\-\_\-cnt\-\_\-print}}
\index{x\-\_\-cnt\-\_\-print@{x\-\_\-cnt\-\_\-print}!adp-tea-f-fk.hh@{adp-\/tea-\/f-\/fk.\-hh}}
\paragraph[{x\-\_\-cnt\-\_\-print}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf x\-\_\-cnt\-\_\-print} (
\begin{DoxyParamCaption}
\item[{uint32\-\_\-t $\ast$$\ast$$\ast$}]{x\-\_\-cnt}
\end{DoxyParamCaption}
)}}\label{adp-tea-f-fk_8hh_a41169fd6ba69f9384b6274c597b473bf}
\-Print the elements of a 2\-D array of differentials. 
\begin{DoxyParams}{\-Parameters}
{\em x\-\_\-cnt} & 2\-D array of differentials. \\
\hline
\end{DoxyParams}

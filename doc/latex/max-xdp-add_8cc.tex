\hypertarget{max-xdp-add_8cc}{\subsection{src/max-\/xdp-\/add.cc \-File \-Reference}
\label{max-xdp-add_8cc}\index{src/max-\/xdp-\/add.\-cc@{src/max-\/xdp-\/add.\-cc}}
}


\-The maximum \-X\-O\-R differential probability of \-A\-D\-D\-: $\max_{dc} \mathrm{xdp}^{+}(da, db \rightarrow dc)$.  


{\ttfamily \#include \char`\"{}common.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}xdp-\/add.\-hh\char`\"{}}\*
\subsubsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{max-xdp-add_8cc_aa26173f5384a2a72da858e5c5c860275}{max\-\_\-xdp\-\_\-add\-\_\-i} (const int i, const uint32\-\_\-t k, const uint32\-\_\-t n, double $\ast$p, uint32\-\_\-t $\ast$dd, gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, gsl\-\_\-vector $\ast$\-B\mbox{[}\hyperlink{common_8hh_a92ed8507d1cd2331ad09275c5c4c1c89}{\-W\-O\-R\-D\-\_\-\-S\-I\-Z\-E}+1\mbox{]}, gsl\-\_\-vector $\ast$\-C, const uint32\-\_\-t da, const uint32\-\_\-t db, uint32\-\_\-t $\ast$dd\-\_\-max, double $\ast$p\-\_\-max, uint32\-\_\-t \-A\-\_\-size)
\item 
void \hyperlink{max-xdp-add_8cc_a248a6a0d0f09adf7a773cd7f1fb1fbe8}{max\-\_\-xdp\-\_\-add\-\_\-bounds} (gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, gsl\-\_\-vector $\ast$\-B\mbox{[}\hyperlink{common_8hh_a92ed8507d1cd2331ad09275c5c4c1c89}{\-W\-O\-R\-D\-\_\-\-S\-I\-Z\-E}+1\mbox{]}, const uint32\-\_\-t da, const uint32\-\_\-t db, uint32\-\_\-t $\ast$dd\-\_\-max, uint32\-\_\-t \-A\-\_\-size)
\item 
double \hyperlink{max-xdp-add_8cc_a19d57935afe7dabc0628a3ea44c1f135}{max\-\_\-xdp\-\_\-add} (gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, const uint32\-\_\-t da, const uint32\-\_\-t db, uint32\-\_\-t $\ast$dd\-\_\-max)
\item 
double \hyperlink{max-xdp-add_8cc_a54f1b6c27d0b3ef04dddcc1e190bc279}{max\-\_\-xdp\-\_\-add\-\_\-exper} (gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, const uint32\-\_\-t da, const uint32\-\_\-t db, uint32\-\_\-t $\ast$dc\-\_\-max)
\item 
double \hyperlink{max-xdp-add_8cc_a1eda58229e5333a889252e475da39f67}{max\-\_\-xdp\-\_\-add\-\_\-lm} (uint32\-\_\-t da, uint32\-\_\-t db, uint32\-\_\-t $\ast$dc\-\_\-ret)
\end{DoxyCompactItemize}


\subsubsection{\-Detailed \-Description}
\-The maximum \-X\-O\-R differential probability of \-A\-D\-D\-: $\max_{dc} \mathrm{xdp}^{+}(da, db \rightarrow dc)$. \begin{DoxyAuthor}{\-Author}
\-V.\-Velichkov, \href{mailto:vesselin.velichkov@uni.lu}{\tt vesselin.\-velichkov@uni.\-lu} 
\end{DoxyAuthor}


\subsubsection{\-Function \-Documentation}
\hypertarget{max-xdp-add_8cc_a19d57935afe7dabc0628a3ea44c1f135}{\index{max-\/xdp-\/add.\-cc@{max-\/xdp-\/add.\-cc}!max\-\_\-xdp\-\_\-add@{max\-\_\-xdp\-\_\-add}}
\index{max\-\_\-xdp\-\_\-add@{max\-\_\-xdp\-\_\-add}!max-xdp-add.cc@{max-\/xdp-\/add.\-cc}}
\paragraph[{max\-\_\-xdp\-\_\-add}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-xdp\-\_\-add} (
\begin{DoxyParamCaption}
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{db, }
\item[{uint32\-\_\-t $\ast$}]{dd\-\_\-max}
\end{DoxyParamCaption}
)}}\label{max-xdp-add_8cc_a19d57935afe7dabc0628a3ea44c1f135}
\-Compute the maximum differential probability over all output differences\-: $\mathrm{max}_{dc}~\mathrm{xdp}^{+}(da,db \rightarrow dc)$. {\bfseries \-Complexity} c\-: $O(n) \le c \le O(2^n)$.


\begin{DoxyParams}{\-Parameters}
{\em \-A} & transition probability matrices. \\
\hline
{\em da} & first input difference. \\
\hline
{\em db} & second input difference. \\
\hline
{\em dd\-\_\-max} & maximum probability output difference. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dc}~\mathrm{xdp}^{+}(da,db \rightarrow dc)$.
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{max-xdp-add_8hh_a19d57935afe7dabc0628a3ea44c1f135}{max\-\_\-xdp\-\_\-add}, \hyperlink{max-xdp-add_8hh_aa26173f5384a2a72da858e5c5c860275}{max\-\_\-xdp\-\_\-add\-\_\-i}, \hyperlink{max-adp-xor_8hh_aa66f59ae4d29988f90f525ce600d6045}{max\-\_\-adp\-\_\-xor} 
\end{DoxySeeAlso}
\hypertarget{max-xdp-add_8cc_a248a6a0d0f09adf7a773cd7f1fb1fbe8}{\index{max-\/xdp-\/add.\-cc@{max-\/xdp-\/add.\-cc}!max\-\_\-xdp\-\_\-add\-\_\-bounds@{max\-\_\-xdp\-\_\-add\-\_\-bounds}}
\index{max\-\_\-xdp\-\_\-add\-\_\-bounds@{max\-\_\-xdp\-\_\-add\-\_\-bounds}!max-xdp-add.cc@{max-\/xdp-\/add.\-cc}}
\paragraph[{max\-\_\-xdp\-\_\-add\-\_\-bounds}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf max\-\_\-xdp\-\_\-add\-\_\-bounds} (
\begin{DoxyParamCaption}
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{gsl\-\_\-vector $\ast$}]{\-B\mbox{[}\-W\-O\-R\-D\-\_\-\-S\-I\-Z\-E+1\mbox{]}, }
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{db, }
\item[{uint32\-\_\-t $\ast$}]{dd\-\_\-max, }
\item[{uint32\-\_\-t}]{\-A\-\_\-size}
\end{DoxyParamCaption}
)}}\label{max-xdp-add_8cc_a248a6a0d0f09adf7a773cd7f1fb1fbe8}
\-Compute an array of bounds that can be used in the computation of the maximum differential probability.


\begin{DoxyParams}{\-Parameters}
{\em \-A} & transition probability matrices. \\
\hline
{\em \-B} & array of size {\ttfamily \-A\-\_\-size} rows by ({\ttfamily n} + 1) columns containing upper bounds on the maximum probabilities of all {\ttfamily j} bit differentials $n \ge j \ge 1$ beginning from any state {\ttfamily i\-:} {\ttfamily \-A\-\_\-size} $> i \ge 0$. \\
\hline
{\em da} & first input difference. \\
\hline
{\em db} & second input difference. \\
\hline
{\em dd\-\_\-max} & maximum probability output difference. \\
\hline
{\em \-A\-\_\-size} & size of the square transition probability matrices (equivalently, the number of states of the \-S-\/function).\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{max-xdp-add_8hh_aa26173f5384a2a72da858e5c5c860275}{max\-\_\-xdp\-\_\-add\-\_\-i}, \hyperlink{max-adp-xor_8hh_ab44746fae93c11ea36bd24f4f874669d}{max\-\_\-adp\-\_\-xor\-\_\-bounds} 
\end{DoxySeeAlso}
\hypertarget{max-xdp-add_8cc_a54f1b6c27d0b3ef04dddcc1e190bc279}{\index{max-\/xdp-\/add.\-cc@{max-\/xdp-\/add.\-cc}!max\-\_\-xdp\-\_\-add\-\_\-exper@{max\-\_\-xdp\-\_\-add\-\_\-exper}}
\index{max\-\_\-xdp\-\_\-add\-\_\-exper@{max\-\_\-xdp\-\_\-add\-\_\-exper}!max-xdp-add.cc@{max-\/xdp-\/add.\-cc}}
\paragraph[{max\-\_\-xdp\-\_\-add\-\_\-exper}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-xdp\-\_\-add\-\_\-exper} (
\begin{DoxyParamCaption}
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{db, }
\item[{uint32\-\_\-t $\ast$}]{dc\-\_\-max}
\end{DoxyParamCaption}
)}}\label{max-xdp-add_8cc_a54f1b6c27d0b3ef04dddcc1e190bc279}
\-Compute the maximum differential probability by exhaustive search over all output differences. {\bfseries \-Complexity\-:} $O(2^n)$.


\begin{DoxyParams}{\-Parameters}
{\em \-A} & transition probability matrices. \\
\hline
{\em da} & first input difference. \\
\hline
{\em db} & second input difference. \\
\hline
{\em dc\-\_\-max} & maximum probability output difference. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dc}~\mathrm{xdp}^{+}(da,db \rightarrow dc)$.
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{max-xdp-add_8hh_a19d57935afe7dabc0628a3ea44c1f135}{max\-\_\-xdp\-\_\-add} 
\end{DoxySeeAlso}
\hypertarget{max-xdp-add_8cc_aa26173f5384a2a72da858e5c5c860275}{\index{max-\/xdp-\/add.\-cc@{max-\/xdp-\/add.\-cc}!max\-\_\-xdp\-\_\-add\-\_\-i@{max\-\_\-xdp\-\_\-add\-\_\-i}}
\index{max\-\_\-xdp\-\_\-add\-\_\-i@{max\-\_\-xdp\-\_\-add\-\_\-i}!max-xdp-add.cc@{max-\/xdp-\/add.\-cc}}
\paragraph[{max\-\_\-xdp\-\_\-add\-\_\-i}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf max\-\_\-xdp\-\_\-add\-\_\-i} (
\begin{DoxyParamCaption}
\item[{const int}]{i, }
\item[{const uint32\-\_\-t}]{k, }
\item[{const uint32\-\_\-t}]{n, }
\item[{double $\ast$}]{p, }
\item[{uint32\-\_\-t $\ast$}]{dd, }
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{gsl\-\_\-vector $\ast$}]{\-B\mbox{[}\-W\-O\-R\-D\-\_\-\-S\-I\-Z\-E+1\mbox{]}, }
\item[{gsl\-\_\-vector $\ast$}]{\-C, }
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{db, }
\item[{uint32\-\_\-t $\ast$}]{dd\-\_\-max, }
\item[{double $\ast$}]{p\-\_\-max, }
\item[{uint32\-\_\-t}]{\-A\-\_\-size}
\end{DoxyParamCaption}
)}}\label{max-xdp-add_8cc_aa26173f5384a2a72da858e5c5c860275}
\-Compute an {\itshape upper\/} {\itshape bound\/} $B[k][i]$ on the maximum probability of the differential $(da[n-1:k], db[n-1:k] \rightarrow dc[n-1:k])$ starting from initial state {\ttfamily i} of the \-S-\/function i.\-e. $\mathrm{dp}(da[n-1:k],db[n-1:k] \rightarrow dc[n-1:k]) = L A_{n-1} A_{n-2} \ldots A_{k} C^{i}_{k-1}$, given the upper bounds $B[k][i]$ on the probabilities of the differentials $(da[n-1:j], db[n-1:j] \rightarrow dc[n-1:j])$ for $j = k+1, k+2, \ldots, n-1$, where $L = [1~1~\ldots~1]$ is a row vector of size {\ttfamily \-A\-\_\-size} and $C^{i}_{k-1}$ is a unit column vector of size {\ttfamily \-A\-\_\-size} with 1 at position $i$ and $C^{i}_{-1} = C$.


\begin{DoxyParams}{\-Parameters}
{\em i} & index of the state of the \-S-\/function\-: {\ttfamily \-A\-\_\-size} $> i \ge 0$. \\
\hline
{\em k} & current bit position\-: $ n > k \ge 0$. \\
\hline
{\em n} & word size. \\
\hline
{\em p} & the estimated probability at bit position {\ttfamily k}. \\
\hline
{\em dd} & output difference. \\
\hline
{\em \-A} & transition probability matrices. \\
\hline
{\em \-B} & array of size {\ttfamily \-A\-\_\-size} rows by ({\ttfamily n} + 1) columns containing upper bounds on the maximum probabilities of all {\ttfamily j} bit differentials $n \ge j \ge 1$ beginning from any state {\ttfamily i\-:} {\ttfamily \-A\-\_\-size} $> i \ge 0$. \\
\hline
{\em \-C} & unit row vector of size {\ttfamily \-A\-\_\-size} rows, initialized with 1 at state index {\ttfamily i}. \\
\hline
{\em da} & first input difference. \\
\hline
{\em db} & second input difference. \\
\hline
{\em dd\-\_\-max} & maximum probability output difference. \\
\hline
{\em p\-\_\-max} & the maximum probability. \\
\hline
{\em \-A\-\_\-size} & size of the square transition probability matrices (equivalently, the number of states of the \-S-\/function).\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{max-adp-xor_8hh_a2c8bd5dba3223b07f3606c2240d0a4b2}{max\-\_\-adp\-\_\-xor\-\_\-i} 
\end{DoxySeeAlso}
\hypertarget{max-xdp-add_8cc_a1eda58229e5333a889252e475da39f67}{\index{max-\/xdp-\/add.\-cc@{max-\/xdp-\/add.\-cc}!max\-\_\-xdp\-\_\-add\-\_\-lm@{max\-\_\-xdp\-\_\-add\-\_\-lm}}
\index{max\-\_\-xdp\-\_\-add\-\_\-lm@{max\-\_\-xdp\-\_\-add\-\_\-lm}!max-xdp-add.cc@{max-\/xdp-\/add.\-cc}}
\paragraph[{max\-\_\-xdp\-\_\-add\-\_\-lm}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-xdp\-\_\-add\-\_\-lm} (
\begin{DoxyParamCaption}
\item[{uint32\-\_\-t}]{da, }
\item[{uint32\-\_\-t}]{db, }
\item[{uint32\-\_\-t $\ast$}]{dc\-\_\-ret}
\end{DoxyParamCaption}
)}}\label{max-xdp-add_8cc_a1eda58229e5333a889252e475da39f67}
\-The maximum differential probability over all output differences\-: in linear time as proposed in \mbox{[}\-Lipmaa, \-Moriai, \-F\-S\-E 2001\mbox{]}\-: $\mathrm{max}_{dc}~\mathrm{xdp}^{+}(da,db \rightarrow dc)$. {\bfseries \-Complexity} c\-: $O(n)$.


\begin{DoxyParams}{\-Parameters}
{\em da} & first input difference. \\
\hline
{\em db} & second input difference. \\
\hline
{\em dc\-\_\-ret} & maximum probability output difference. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dc}~\mathrm{xdp}^{+}(da,db \rightarrow dc)$.
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{max-xdp-add_8hh_a19d57935afe7dabc0628a3ea44c1f135}{max\-\_\-xdp\-\_\-add} 
\end{DoxySeeAlso}

\hypertarget{xdp-tea-f-fk_8cc}{\subsection{src/xdp-\/tea-\/f-\/fk.cc \-File \-Reference}
\label{xdp-tea-f-fk_8cc}\index{src/xdp-\/tea-\/f-\/fk.\-cc@{src/xdp-\/tea-\/f-\/fk.\-cc}}
}


\-The \-X\-O\-R differential probability (\-X\-D\-P) of the \-F-\/function of \-T\-E\-A for a fixed key and round constants\-: $\mathrm{xdp}^{F}(k_0, k_1, \delta |~ da \rightarrow dd)$.  


{\ttfamily \#include \char`\"{}common.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}tea.\-hh\char`\"{}}\*
\subsubsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{xdp-tea-f-fk_8cc_af2db89390c1b79d21e9426301133677a}{xdp\-\_\-f\-\_\-fk\-\_\-exper} (const uint32\-\_\-t da, const uint32\-\_\-t db, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, uint32\-\_\-t lsh\-\_\-const, uint32\-\_\-t rsh\-\_\-const)
\item 
double \hyperlink{xdp-tea-f-fk_8cc_ae697ec9a1dcb67277eee7817501f9fa9}{max\-\_\-xdp\-\_\-f\-\_\-fk\-\_\-dx\-\_\-exper} (uint32\-\_\-t $\ast$max\-\_\-dx, const uint32\-\_\-t dy, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, uint32\-\_\-t lsh\-\_\-const, uint32\-\_\-t rsh\-\_\-const)
\item 
double \hyperlink{xdp-tea-f-fk_8cc_a3eba231310409bff7512be456f0329b4}{max\-\_\-xdp\-\_\-f\-\_\-fk\-\_\-dy\-\_\-exper} (const uint32\-\_\-t dx, uint32\-\_\-t $\ast$max\-\_\-dy, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, uint32\-\_\-t lsh\-\_\-const, uint32\-\_\-t rsh\-\_\-const)
\item 
bool \hyperlink{xdp-tea-f-fk_8cc_aba9a33f69d29af6f9ffea5590bc902d2}{xdp\-\_\-f\-\_\-is\-\_\-sat} (const uint32\-\_\-t mask\-\_\-i, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t dx, const uint32\-\_\-t dy, int32\-\_\-t x)
\item 
bool \hyperlink{xdp-tea-f-fk_8cc_a3aa2bec1e1d27e27741f2f7e46f4ac28}{xdp\-\_\-f\-\_\-check\-\_\-x} (const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t dx, const uint32\-\_\-t dy, const uint32\-\_\-t x)
\item 
uint32\-\_\-t \hyperlink{xdp-tea-f-fk_8cc_acce345a641b8a7372b2b2a562fc1ba8c}{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x} (const uint32\-\_\-t n, const uint32\-\_\-t i, const uint32\-\_\-t mask\-\_\-i, const uint32\-\_\-t x, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t dx, const uint32\-\_\-t dy, uint32\-\_\-t $\ast$x\-\_\-cnt, double $\ast$prob)
\item 
double \hyperlink{xdp-tea-f-fk_8cc_aa4597c33ca147a102d557fc93c23b802}{xdp\-\_\-f\-\_\-fk} (const uint32\-\_\-t n, const uint32\-\_\-t dx, const uint32\-\_\-t dy, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const)
\item 
uint32\-\_\-t \hyperlink{xdp-tea-f-fk_8cc_a1115a644e425e49a0302d119e0eb9db0}{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx} (const uint32\-\_\-t n, const uint32\-\_\-t i, const uint32\-\_\-t mask\-\_\-i, const uint32\-\_\-t x, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t dx, const uint32\-\_\-t dy, uint64\-\_\-t $\ast$x\-\_\-cnt, double $\ast$ret\-\_\-prob, uint32\-\_\-t $\ast$ret\-\_\-dx)
\item 
double \hyperlink{xdp-tea-f-fk_8cc_af6dac18b8bf6b15b03e2210b186ed2a9}{max\-\_\-dx\-\_\-xdp\-\_\-f\-\_\-fk} (const uint32\-\_\-t n, uint32\-\_\-t $\ast$ret\-\_\-dx, const uint32\-\_\-t dy, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const)
\item 
uint32\-\_\-t \hyperlink{xdp-tea-f-fk_8cc_a721c7a6460f6461ab7267f40098734e0}{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy} (const uint32\-\_\-t n, const uint32\-\_\-t i, const uint32\-\_\-t mask\-\_\-i, const uint32\-\_\-t x, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t dx, const uint32\-\_\-t dy, uint64\-\_\-t $\ast$x\-\_\-cnt, double $\ast$ret\-\_\-prob, uint32\-\_\-t $\ast$ret\-\_\-dy)
\item 
double \hyperlink{xdp-tea-f-fk_8cc_a14a72673bfe0665f3584a45ed480ead0}{max\-\_\-dy\-\_\-xdp\-\_\-f\-\_\-fk} (const uint32\-\_\-t n, const uint32\-\_\-t dx, uint32\-\_\-t $\ast$ret\-\_\-dy, const uint32\-\_\-t k0, const uint32\-\_\-t k1, const uint32\-\_\-t delta, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const)
\end{DoxyCompactItemize}


\subsubsection{\-Detailed \-Description}
\-The \-X\-O\-R differential probability (\-X\-D\-P) of the \-F-\/function of \-T\-E\-A for a fixed key and round constants\-: $\mathrm{xdp}^{F}(k_0, k_1, \delta |~ da \rightarrow dd)$. \begin{DoxyAuthor}{\-Author}
\-V.\-Velichkov, \href{mailto:vesselin.velichkov@uni.lu}{\tt vesselin.\-velichkov@uni.\-lu} 
\end{DoxyAuthor}
\begin{DoxyAttention}{\-Attention}
\-The algorithms in this file have complexity that depends on the input and output differences to \-F. \-It is worst-\/case exponential in the word size, but is sub-\/exponential on average. 
\end{DoxyAttention}


\subsubsection{\-Function \-Documentation}
\hypertarget{xdp-tea-f-fk_8cc_af6dac18b8bf6b15b03e2210b186ed2a9}{\index{xdp-\/tea-\/f-\/fk.\-cc@{xdp-\/tea-\/f-\/fk.\-cc}!max\-\_\-dx\-\_\-xdp\-\_\-f\-\_\-fk@{max\-\_\-dx\-\_\-xdp\-\_\-f\-\_\-fk}}
\index{max\-\_\-dx\-\_\-xdp\-\_\-f\-\_\-fk@{max\-\_\-dx\-\_\-xdp\-\_\-f\-\_\-fk}!xdp-tea-f-fk.cc@{xdp-\/tea-\/f-\/fk.\-cc}}
\paragraph[{max\-\_\-dx\-\_\-xdp\-\_\-f\-\_\-fk}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-dx\-\_\-xdp\-\_\-f\-\_\-fk} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{xdp-tea-f-fk_8cc_af6dac18b8bf6b15b03e2210b186ed2a9}
\-For given output difference {\ttfamily dy}, compute the maximum probability input differences {\ttfamily dx} over all input differences\-: $\mathrm{max}_{dx} ~\mathrm{xdp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. {\bfseries \-Complexity\-:} $ O(2n) < c \le O(2^{2n}) $. {\bfseries \-Memory\-:} $4 \cdot 2^n$ \-Bytes.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size. \\
\hline
{\em ret\-\_\-dx} & maximum probability input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dx} ~\mathrm{xdp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{xdp-tea-f-fk_8hh_a1115a644e425e49a0302d119e0eb9db0}{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx} 
\end{DoxySeeAlso}
\hypertarget{xdp-tea-f-fk_8cc_a14a72673bfe0665f3584a45ed480ead0}{\index{xdp-\/tea-\/f-\/fk.\-cc@{xdp-\/tea-\/f-\/fk.\-cc}!max\-\_\-dy\-\_\-xdp\-\_\-f\-\_\-fk@{max\-\_\-dy\-\_\-xdp\-\_\-f\-\_\-fk}}
\index{max\-\_\-dy\-\_\-xdp\-\_\-f\-\_\-fk@{max\-\_\-dy\-\_\-xdp\-\_\-f\-\_\-fk}!xdp-tea-f-fk.cc@{xdp-\/tea-\/f-\/fk.\-cc}}
\paragraph[{max\-\_\-dy\-\_\-xdp\-\_\-f\-\_\-fk}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-dy\-\_\-xdp\-\_\-f\-\_\-fk} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dy, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{xdp-tea-f-fk_8cc_a14a72673bfe0665f3584a45ed480ead0}
\-For given input difference {\ttfamily dx}, compute the maximum probability output difference {\ttfamily dy} over all output differences\-: $\mathrm{max}_{dy} ~\mathrm{xdp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. {\bfseries \-Complexity\-:} $ O(2n) < c \le O(2^{2n}) $. {\bfseries \-Memory} {\bfseries requirement\-:} $4 \cdot 2^n$ \-Bytes.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size. \\
\hline
{\em dx} & input difference. \\
\hline
{\em ret\-\_\-dy} & maximum probability output difference. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dy} ~\mathrm{xdp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{xdp-tea-f-fk_8hh_a721c7a6460f6461ab7267f40098734e0}{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy}, \hyperlink{xdp-tea-f-fk_8hh_a14a72673bfe0665f3584a45ed480ead0}{max\-\_\-dy\-\_\-xdp\-\_\-f\-\_\-fk} 
\end{DoxySeeAlso}
\hypertarget{xdp-tea-f-fk_8cc_ae697ec9a1dcb67277eee7817501f9fa9}{\index{xdp-\/tea-\/f-\/fk.\-cc@{xdp-\/tea-\/f-\/fk.\-cc}!max\-\_\-xdp\-\_\-f\-\_\-fk\-\_\-dx\-\_\-exper@{max\-\_\-xdp\-\_\-f\-\_\-fk\-\_\-dx\-\_\-exper}}
\index{max\-\_\-xdp\-\_\-f\-\_\-fk\-\_\-dx\-\_\-exper@{max\-\_\-xdp\-\_\-f\-\_\-fk\-\_\-dx\-\_\-exper}!xdp-tea-f-fk.cc@{xdp-\/tea-\/f-\/fk.\-cc}}
\paragraph[{max\-\_\-xdp\-\_\-f\-\_\-fk\-\_\-dx\-\_\-exper}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-xdp\-\_\-f\-\_\-fk\-\_\-dx\-\_\-exper} (
\begin{DoxyParamCaption}
\item[{uint32\-\_\-t $\ast$}]{max\-\_\-dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{xdp-tea-f-fk_8cc_ae697ec9a1dcb67277eee7817501f9fa9}
\-For given output difference {\ttfamily dy}, compute the maximum probability input differences {\ttfamily dx} over all input differences\-: $\mathrm{max}_{dx} ~\mathrm{xdp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$ through exhaustive search over all input values and input differences. {\bfseries \-Complexity\-:} $O(2^{2n})$.


\begin{DoxyParams}{\-Parameters}
{\em max\-\_\-dx} & maximum probability input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dx} ~\mathrm{xdp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{xdp-tea-f-fk_8hh_af6dac18b8bf6b15b03e2210b186ed2a9}{max\-\_\-dx\-\_\-xdp\-\_\-f\-\_\-fk} 
\end{DoxySeeAlso}
\hypertarget{xdp-tea-f-fk_8cc_a3eba231310409bff7512be456f0329b4}{\index{xdp-\/tea-\/f-\/fk.\-cc@{xdp-\/tea-\/f-\/fk.\-cc}!max\-\_\-xdp\-\_\-f\-\_\-fk\-\_\-dy\-\_\-exper@{max\-\_\-xdp\-\_\-f\-\_\-fk\-\_\-dy\-\_\-exper}}
\index{max\-\_\-xdp\-\_\-f\-\_\-fk\-\_\-dy\-\_\-exper@{max\-\_\-xdp\-\_\-f\-\_\-fk\-\_\-dy\-\_\-exper}!xdp-tea-f-fk.cc@{xdp-\/tea-\/f-\/fk.\-cc}}
\paragraph[{max\-\_\-xdp\-\_\-f\-\_\-fk\-\_\-dy\-\_\-exper}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-xdp\-\_\-f\-\_\-fk\-\_\-dy\-\_\-exper} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{dx, }
\item[{uint32\-\_\-t $\ast$}]{max\-\_\-dy, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{xdp-tea-f-fk_8cc_a3eba231310409bff7512be456f0329b4}
\-For given input difference {\ttfamily dx}, compute the maximum probability output difference {\ttfamily dy} over all output differences\-: $\mathrm{max}_{dy} ~\mathrm{xdp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$ through exhaustive search over all input values and input differences. {\bfseries \-Complexity\-:} $O(2^{2n})$.


\begin{DoxyParams}{\-Parameters}
{\em dx} & input difference. \\
\hline
{\em max\-\_\-dy} & maximum probability output difference. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{dx} ~\mathrm{xdp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{xdp-tea-f-fk_8hh_a14a72673bfe0665f3584a45ed480ead0}{max\-\_\-dy\-\_\-xdp\-\_\-f\-\_\-fk} 
\end{DoxySeeAlso}
\hypertarget{xdp-tea-f-fk_8cc_acce345a641b8a7372b2b2a562fc1ba8c}{\index{xdp-\/tea-\/f-\/fk.\-cc@{xdp-\/tea-\/f-\/fk.\-cc}!xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x@{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x}}
\index{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x@{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x}!xdp-tea-f-fk.cc@{xdp-\/tea-\/f-\/fk.\-cc}}
\paragraph[{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t {\bf xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{const uint32\-\_\-t}]{i, }
\item[{const uint32\-\_\-t}]{mask\-\_\-i, }
\item[{const uint32\-\_\-t}]{x, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{uint32\-\_\-t $\ast$}]{x\-\_\-cnt, }
\item[{double $\ast$}]{prob}
\end{DoxyParamCaption}
)}}\label{xdp-tea-f-fk_8cc_acce345a641b8a7372b2b2a562fc1ba8c}
\-Counts the number of values {\ttfamily x} for which the differential $(dx \rightarrow dy)$ for the \-F-\/function of \-T\-E\-A is satisfied. \-The function operates by recursively assigning the bits of {\ttfamily x} starting from bit position {\ttfamily i} and terminating at the \-M\-S bit {\ttfamily n}. \-The recursion proceeds to bit $(i+1)$ only if the differential is satisfied on the {\ttfamily i} \-L\-S bits. \-This is checked by applying \hyperlink{xdp-tea-f-fk_8hh_aba9a33f69d29af6f9ffea5590bc902d2}{xdp\-\_\-f\-\_\-is\-\_\-sat}.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size (terminating bit popsition). \\
\hline
{\em i} & current bit position. \\
\hline
{\em mask\-\_\-i} & mask on the {\ttfamily i} \-L\-S bits of {\ttfamily x}. \\
\hline
{\em x} & input value of size at least ({\ttfamily i} + {\ttfamily rsh\-\_\-const}). \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em dx} & input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em x\-\_\-cnt} & number of values satisfying $(dx \rightarrow dy)$. \\
\hline
{\em prob} & the fixed-\/key \-X\-O\-R probability of {\ttfamily \-F\-:} $\mathrm{xdp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
{\ttfamily 1} if $x[i-1:0]$ satisfies $(dx[i-1:0] \rightarrow dy[i-1:0])$; {\ttfamily 0} otherwise. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{xdp-tea-f-fk_8hh_aa4597c33ca147a102d557fc93c23b802}{xdp\-\_\-f\-\_\-fk} 
\end{DoxySeeAlso}
\hypertarget{xdp-tea-f-fk_8cc_a1115a644e425e49a0302d119e0eb9db0}{\index{xdp-\/tea-\/f-\/fk.\-cc@{xdp-\/tea-\/f-\/fk.\-cc}!xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx@{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx}}
\index{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx@{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx}!xdp-tea-f-fk.cc@{xdp-\/tea-\/f-\/fk.\-cc}}
\paragraph[{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t {\bf xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{const uint32\-\_\-t}]{i, }
\item[{const uint32\-\_\-t}]{mask\-\_\-i, }
\item[{const uint32\-\_\-t}]{x, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{uint64\-\_\-t $\ast$}]{x\-\_\-cnt, }
\item[{double $\ast$}]{ret\-\_\-prob, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dx}
\end{DoxyParamCaption}
)}}\label{xdp-tea-f-fk_8cc_a1115a644e425e49a0302d119e0eb9db0}
\-For given output difference {\ttfamily dy}, compute all input differences {\ttfamily dx} and their probabilities, by counting all values {\ttfamily x} that satisfy the differential $(dx \rightarrow dy)$ for a fixed key and round constant. \-At the same time keeps track of the maximum probability input difference.

\-The function works by recursively assigning the bits of {\ttfamily x} and {\ttfamily dx} starting at bit position {\ttfamily i} and terminating at the \-M\-S bit {\ttfamily n}. \-The recursion proceeds to bit $(i+1)$ only if the differential is satisfied on the {\ttfamily i} \-L\-S bits. \-This is checked by applying \hyperlink{xdp-tea-f-fk_8hh_aba9a33f69d29af6f9ffea5590bc902d2}{xdp\-\_\-f\-\_\-is\-\_\-sat} .


\begin{DoxyParams}{\-Parameters}
{\em n} & word size (terminating bit popsition). \\
\hline
{\em i} & current bit position. \\
\hline
{\em mask\-\_\-i} & mask on the {\ttfamily i} \-L\-S bits of {\ttfamily x}. \\
\hline
{\em x} & input value of size at least ({\ttfamily i} + {\ttfamily rsh\-\_\-const}). \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em dx} & input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em x\-\_\-cnt} & array of $2^n$ counters -\/ each one keeps track of the number of values satisfying $(dx \rightarrow dy)$ for every {\ttfamily dx}. \\
\hline
{\em ret\-\_\-prob} & the maximum probability over all input differences $\mathrm{max}_{dx} ~\mathrm{xdp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. \\
\hline
{\em ret\-\_\-dx} & the input difference that has maximum probability. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
{\ttfamily 1} if $x[i-1:0]$ satisfies $(dx[i-1:0] \rightarrow dy[i-1:0])$; {\ttfamily 0} otherwise.
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{xdp-tea-f-fk_8hh_acce345a641b8a7372b2b2a562fc1ba8c}{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x}, \hyperlink{xdp-tea-f-fk_8hh_af6dac18b8bf6b15b03e2210b186ed2a9}{max\-\_\-dx\-\_\-xdp\-\_\-f\-\_\-fk} 
\end{DoxySeeAlso}
\hypertarget{xdp-tea-f-fk_8cc_a721c7a6460f6461ab7267f40098734e0}{\index{xdp-\/tea-\/f-\/fk.\-cc@{xdp-\/tea-\/f-\/fk.\-cc}!xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy@{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy}}
\index{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy@{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy}!xdp-tea-f-fk.cc@{xdp-\/tea-\/f-\/fk.\-cc}}
\paragraph[{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t {\bf xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dy} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{const uint32\-\_\-t}]{i, }
\item[{const uint32\-\_\-t}]{mask\-\_\-i, }
\item[{const uint32\-\_\-t}]{x, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{uint64\-\_\-t $\ast$}]{x\-\_\-cnt, }
\item[{double $\ast$}]{ret\-\_\-prob, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dy}
\end{DoxyParamCaption}
)}}\label{xdp-tea-f-fk_8cc_a721c7a6460f6461ab7267f40098734e0}
\-For given input difference {\ttfamily dx}, compute all output differences {\ttfamily dy} and their probabilities, by counting all values {\ttfamily x} that satisfy the differential $(dx \rightarrow dy)$ for a fixed key and round constant. \-At the same time keeps track of the maximum probability output difference.

\-The function works by recursively assigning the bits of {\ttfamily x} and {\ttfamily dy} starting at bit position {\ttfamily i} and terminating at the \-M\-S bit {\ttfamily n}. \-The recursion proceeds to bit $(i+1)$ only if the differential is satisfied on the {\ttfamily i} \-L\-S bits. \-This is checked by applying \hyperlink{xdp-tea-f-fk_8hh_aba9a33f69d29af6f9ffea5590bc902d2}{xdp\-\_\-f\-\_\-is\-\_\-sat}.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size (terminating bit popsition). \\
\hline
{\em i} & current bit position. \\
\hline
{\em mask\-\_\-i} & mask on the {\ttfamily i} \-L\-S bits of {\ttfamily x}. \\
\hline
{\em x} & input value of size at least ({\ttfamily i} + {\ttfamily rsh\-\_\-const}). \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em dx} & input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em x\-\_\-cnt} & array of $2^n$ counters -\/ each one keeps track of the number of values satisfying $(dx \rightarrow dy)$ for every {\ttfamily dy}. \\
\hline
{\em ret\-\_\-prob} & the maximum probability over all output differences $\mathrm{max}_{dy} ~\mathrm{xdp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. \\
\hline
{\em ret\-\_\-dy} & the output difference that has maximum probability. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
{\ttfamily 1} if $x[i-1:0]$ satisfies $(dx[i-1:0] \rightarrow dy[i-1:0])$; {\ttfamily 0} otherwise.
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{xdp-tea-f-fk_8hh_a1115a644e425e49a0302d119e0eb9db0}{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x\-\_\-dx} 
\end{DoxySeeAlso}
\hypertarget{xdp-tea-f-fk_8cc_a3aa2bec1e1d27e27741f2f7e46f4ac28}{\index{xdp-\/tea-\/f-\/fk.\-cc@{xdp-\/tea-\/f-\/fk.\-cc}!xdp\-\_\-f\-\_\-check\-\_\-x@{xdp\-\_\-f\-\_\-check\-\_\-x}}
\index{xdp\-\_\-f\-\_\-check\-\_\-x@{xdp\-\_\-f\-\_\-check\-\_\-x}!xdp-tea-f-fk.cc@{xdp-\/tea-\/f-\/fk.\-cc}}
\paragraph[{xdp\-\_\-f\-\_\-check\-\_\-x}]{\setlength{\rightskip}{0pt plus 5cm}bool {\bf xdp\-\_\-f\-\_\-check\-\_\-x} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{const uint32\-\_\-t}]{x}
\end{DoxyParamCaption}
)}}\label{xdp-tea-f-fk_8cc_a3aa2bec1e1d27e27741f2f7e46f4ac28}
\-Check if a given value {\ttfamily x} satisfies the \-X\-O\-R differential $(dx \rightarrow dy)$ for the \-T\-E\-A \-F-\/function.


\begin{DoxyParams}{\-Parameters}
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em dx} & input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em x} & input value. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-T\-R\-U\-E if $k_0, k_1, \delta:~ dy = F(x \oplus dx) \oplus F(x)$. 
\end{DoxyReturn}
\hypertarget{xdp-tea-f-fk_8cc_aa4597c33ca147a102d557fc93c23b802}{\index{xdp-\/tea-\/f-\/fk.\-cc@{xdp-\/tea-\/f-\/fk.\-cc}!xdp\-\_\-f\-\_\-fk@{xdp\-\_\-f\-\_\-fk}}
\index{xdp\-\_\-f\-\_\-fk@{xdp\-\_\-f\-\_\-fk}!xdp-tea-f-fk.cc@{xdp-\/tea-\/f-\/fk.\-cc}}
\paragraph[{xdp\-\_\-f\-\_\-fk}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf xdp\-\_\-f\-\_\-fk} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{n, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{xdp-tea-f-fk_8cc_aa4597c33ca147a102d557fc93c23b802}
\-Compute the fixed-\/key, fixed-\/constant \-X\-O\-R differential probability of the \-F-\/function of block cipher \-T\-E\-A\-: $\mathrm{xdp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. {\bfseries \-Complexity\-:} $ O(n) < c \le O(2^n) $.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size. \\
\hline
{\em dx} & input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{xdp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{xdp-tea-f-fk_8hh_acce345a641b8a7372b2b2a562fc1ba8c}{xdp\-\_\-f\-\_\-assign\-\_\-bit\-\_\-x} 
\end{DoxySeeAlso}
\hypertarget{xdp-tea-f-fk_8cc_af2db89390c1b79d21e9426301133677a}{\index{xdp-\/tea-\/f-\/fk.\-cc@{xdp-\/tea-\/f-\/fk.\-cc}!xdp\-\_\-f\-\_\-fk\-\_\-exper@{xdp\-\_\-f\-\_\-fk\-\_\-exper}}
\index{xdp\-\_\-f\-\_\-fk\-\_\-exper@{xdp\-\_\-f\-\_\-fk\-\_\-exper}!xdp-tea-f-fk.cc@{xdp-\/tea-\/f-\/fk.\-cc}}
\paragraph[{xdp\-\_\-f\-\_\-fk\-\_\-exper}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf xdp\-\_\-f\-\_\-fk\-\_\-exper} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{db, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{xdp-tea-f-fk_8cc_af2db89390c1b79d21e9426301133677a}
\-Compute the fixed-\/key, fixed-\/constant \-X\-O\-R differential probability of the \-F-\/function of block cipher \-T\-E\-A\-: $\mathrm{xdp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$ through exhaustive search over all input values. {\bfseries \-Complexity\-:} $O(2^n)$.


\begin{DoxyParams}{\-Parameters}
{\em da} & input difference. \\
\hline
{\em db} & output difference. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{xdp}^{F}(k_0, k_1, \delta |~ dx \rightarrow dy)$. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{xdp-tea-f-fk_8hh_aa4597c33ca147a102d557fc93c23b802}{xdp\-\_\-f\-\_\-fk} 
\end{DoxySeeAlso}
\hypertarget{xdp-tea-f-fk_8cc_aba9a33f69d29af6f9ffea5590bc902d2}{\index{xdp-\/tea-\/f-\/fk.\-cc@{xdp-\/tea-\/f-\/fk.\-cc}!xdp\-\_\-f\-\_\-is\-\_\-sat@{xdp\-\_\-f\-\_\-is\-\_\-sat}}
\index{xdp\-\_\-f\-\_\-is\-\_\-sat@{xdp\-\_\-f\-\_\-is\-\_\-sat}!xdp-tea-f-fk.cc@{xdp-\/tea-\/f-\/fk.\-cc}}
\paragraph[{xdp\-\_\-f\-\_\-is\-\_\-sat}]{\setlength{\rightskip}{0pt plus 5cm}bool {\bf xdp\-\_\-f\-\_\-is\-\_\-sat} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{mask\-\_\-i, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{k0, }
\item[{const uint32\-\_\-t}]{k1, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{int32\-\_\-t}]{x}
\end{DoxyParamCaption}
)}}\label{xdp-tea-f-fk_8cc_aba9a33f69d29af6f9ffea5590bc902d2}
\-Check if the differential $(dx \rightarrow dy)$ for {\ttfamily \-F} is satisfied on the {\ttfamily i} \-L\-S bits of {\ttfamily x} i.\-e. check if $k_0, k_1, \delta:~ dy[i-1:0] = F(x[i-1:0] \oplus dx[i-1:0]) \oplus F(x[i-1:0])$.

\begin{DoxyAttention}{\-Attention}
{\ttfamily x} must be of size at least $(i + R)$ bits where {\ttfamily \-R} is the \-R\-S\-H constant of {\ttfamily \-F}.
\end{DoxyAttention}

\begin{DoxyParams}{\-Parameters}
{\em mask\-\_\-i} & {\ttfamily i} bit mask. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
{\em k0} & first round key. \\
\hline
{\em k1} & second round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em dx} & input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em x} & input value of size at least ({\ttfamily i} + {\ttfamily rsh\-\_\-const}). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-T\-R\-U\-E if $k_0, k_1, \delta:~ dy[i-1:0] = F(x[i-1:0] \oplus dx[i-1:0]) \oplus F(x[i-1:0)$. 
\end{DoxyReturn}

\hypertarget{eadp-tea-f_8cc}{\subsection{src/eadp-\/tea-\/f.cc \-File \-Reference}
\label{eadp-tea-f_8cc}\index{src/eadp-\/tea-\/f.\-cc@{src/eadp-\/tea-\/f.\-cc}}
}


\-The expected additive differential probability (\-E\-A\-D\-P) of the \-F-\/function of \-T\-E\-A, averaged over all round keys and constants\-: $\mathrm{eadp}^{F}(da \rightarrow dd)$. \-Complexity\-: $O(n)$.  


{\ttfamily \#include \char`\"{}common.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}adp-\/xor3.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}max-\/adp-\/xor3-\/set.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}adp-\/shift.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}tea.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}eadp-\/tea-\/f.\-hh\char`\"{}}\*
\subsubsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{eadp-tea-f_8cc_ae0d8d129c4fcabd34fae362f4785cca2}{eadp\-\_\-tea\-\_\-f\-\_\-exper} (const uint32\-\_\-t dx, const uint32\-\_\-t dy, uint32\-\_\-t lsh\-\_\-const, uint32\-\_\-t rsh\-\_\-const)
\item 
double \hyperlink{eadp-tea-f_8cc_a2b46cad5e0dd22f116160ef8fde6e15f}{eadp\-\_\-tea\-\_\-f} (gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, const uint32\-\_\-t da, const uint32\-\_\-t db, double $\ast$prob\-\_\-db, uint32\-\_\-t lsh\-\_\-const, uint32\-\_\-t rsh\-\_\-const)
\item 
double \hyperlink{eadp-tea-f_8cc_afecdbe906e7af3483f251d65512f85f7}{max\-\_\-eadp\-\_\-tea\-\_\-f} (gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, const uint32\-\_\-t da, uint32\-\_\-t $\ast$dd\-\_\-max, double $\ast$prob\-\_\-max, uint32\-\_\-t lsh\-\_\-const, uint32\-\_\-t rsh\-\_\-const)
\item 
double \hyperlink{eadp-tea-f_8cc_a677d6b3bc42aae321e2f4a3ec91640d5}{max\-\_\-eadp\-\_\-tea\-\_\-f\-\_\-exper} (gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, const uint32\-\_\-t da, uint32\-\_\-t $\ast$dd\-\_\-max, double $\ast$prob\-\_\-max, uint32\-\_\-t lsh\-\_\-const, uint32\-\_\-t rsh\-\_\-const)
\item 
void \hyperlink{eadp-tea-f_8cc_a934bdfebbd560419bbe519ce81d27bcf}{nz\-\_\-eadp\-\_\-tea\-\_\-f\-\_\-i} (const uint32\-\_\-t k, const uint32\-\_\-t n, gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, gsl\-\_\-vector $\ast$\-C, const uint32\-\_\-t da, const uint32\-\_\-t db, const uint32\-\_\-t dc, uint32\-\_\-t $\ast$dd, double $\ast$p, double $\ast$p\-\_\-thres, uint32\-\_\-t $\ast$ret\-\_\-dd, double $\ast$ret\-\_\-p, uint32\-\_\-t $\ast$cnt, uint32\-\_\-t max\-\_\-cnt)
\item 
double \hyperlink{eadp-tea-f_8cc_a288ad628f2a68f2f32c7c065a2c87e82}{nz\-\_\-eadp\-\_\-tea\-\_\-f} (gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, double p\-\_\-thres, uint32\-\_\-t da, uint32\-\_\-t $\ast$ret\-\_\-dd)
\end{DoxyCompactItemize}


\subsubsection{\-Detailed \-Description}
\-The expected additive differential probability (\-E\-A\-D\-P) of the \-F-\/function of \-T\-E\-A, averaged over all round keys and constants\-: $\mathrm{eadp}^{F}(da \rightarrow dd)$. \-Complexity\-: $O(n)$. \begin{DoxyAuthor}{\-Author}
\-V.\-Velichkov, \href{mailto:vesselin.velichkov@uni.lu}{\tt vesselin.\-velichkov@uni.\-lu} 
\end{DoxyAuthor}


\subsubsection{\-Function \-Documentation}
\hypertarget{eadp-tea-f_8cc_a2b46cad5e0dd22f116160ef8fde6e15f}{\index{eadp-\/tea-\/f.\-cc@{eadp-\/tea-\/f.\-cc}!eadp\-\_\-tea\-\_\-f@{eadp\-\_\-tea\-\_\-f}}
\index{eadp\-\_\-tea\-\_\-f@{eadp\-\_\-tea\-\_\-f}!eadp-tea-f.cc@{eadp-\/tea-\/f.\-cc}}
\paragraph[{eadp\-\_\-tea\-\_\-f}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf eadp\-\_\-tea\-\_\-f} (
\begin{DoxyParamCaption}
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{db, }
\item[{double $\ast$}]{prob\-\_\-db, }
\item[{uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{eadp-tea-f_8cc_a2b46cad5e0dd22f116160ef8fde6e15f}
\-Computing the expected additive differential probability (\-E\-A\-D\-P) of the \-F-\/function of \-T\-E\-A, averaged over all round keys and constants. \-For fixed input and output differences resp. {\ttfamily da} and {\ttfamily db}, it is defined as\-:

$\mathrm{eadp}^{F}(da \rightarrow db) = 2^{-4n}~\{\#(k_0,k_1,\delta,x) : F(x + da) - F(x) = db\}$.

{\bfseries \-Complexity\-:} $O(n)$.

{\bfseries \-Algorithm} {\bfseries sketch\-:} $\mathrm{eadp}^{F}$ is computed as the multiplication of \-A\-D\-P-\/s of the two non-\/linear (w.\-r.\-t. \-A\-D\-D differences) components of \-F, namely \-X\-O\-R and \-L\-S\-H\-:

\[\mathrm{eadp}^{F}(da \rightarrow db) = (\sum^3_{i=0} (\mathrm{adp}^{\gg 5}(da, dc_i)))~ \cdot~ \mathrm{adp}^{3\oplus}_{\mathrm{SET}}((da \ll 4), da, \{dc_0, dc_1, dc_2, dc_3\} \rightarrow db)\]

where $dc_i \in \{(da \gg 5), (da \gg 5) + 1, (da \gg 5) - 2^{n-5}, (da \gg 5) - 2^{n-5} + 1\}$ are the four possible \-A\-D\-D differences after \-R\-S\-H (see \hyperlink{adp-shift_8hh_a06fffd781af6662482922889bc562caf}{adp\-\_\-rsh}) and $\mathrm{adp}^{3\oplus}_{\mathrm{SET}}$ is the \-A\-D\-P of \-X\-O\-R with three inputs where one of the inputs may satisfy any difference from a given {\itshape set\/} (\hyperlink{max-adp-xor3-set_8hh_a64619e5349dd07dc017b0469b4066fce}{max\-\_\-adp\-\_\-xor3\-\_\-set}).


\begin{DoxyParams}{\-Parameters}
{\em \-A} & transition probability matrices for $\mathrm{adp}^{3\oplus}$ (\hyperlink{adp-xor3_8hh_a229a19749624926d15eb5b1731379855}{adp\-\_\-xor3\-\_\-sf}). \\
\hline
{\em da} & input difference. \\
\hline
{\em db} & output difference. \\
\hline
{\em prob\-\_\-db} & the expected \-D\-P of \-F. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{eadp}^{F}(da \rightarrow db)$. 
\end{DoxyReturn}
\hypertarget{eadp-tea-f_8cc_ae0d8d129c4fcabd34fae362f4785cca2}{\index{eadp-\/tea-\/f.\-cc@{eadp-\/tea-\/f.\-cc}!eadp\-\_\-tea\-\_\-f\-\_\-exper@{eadp\-\_\-tea\-\_\-f\-\_\-exper}}
\index{eadp\-\_\-tea\-\_\-f\-\_\-exper@{eadp\-\_\-tea\-\_\-f\-\_\-exper}!eadp-tea-f.cc@{eadp-\/tea-\/f.\-cc}}
\paragraph[{eadp\-\_\-tea\-\_\-f\-\_\-exper}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf eadp\-\_\-tea\-\_\-f\-\_\-exper} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{dx, }
\item[{const uint32\-\_\-t}]{dy, }
\item[{uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{eadp-tea-f_8cc_ae0d8d129c4fcabd34fae362f4785cca2}
\-Computing the expected additive differential probability (\-E\-A\-D\-P) of the \-F-\/function of \-T\-E\-A (see \hyperlink{eadp-tea-f_8hh_a2b46cad5e0dd22f116160ef8fde6e15f}{eadp\-\_\-tea\-\_\-f}), experimentally over all round keys and constants.

{\bfseries \-Complexity\-:} $O(2^{4n})$.


\begin{DoxyParams}{\-Parameters}
{\em dx} & input difference. \\
\hline
{\em dy} & output difference. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{eadp}^{F}(da \rightarrow db)$.
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{eadp-tea-f_8hh_a2b46cad5e0dd22f116160ef8fde6e15f}{eadp\-\_\-tea\-\_\-f} 
\end{DoxySeeAlso}
\hypertarget{eadp-tea-f_8cc_afecdbe906e7af3483f251d65512f85f7}{\index{eadp-\/tea-\/f.\-cc@{eadp-\/tea-\/f.\-cc}!max\-\_\-eadp\-\_\-tea\-\_\-f@{max\-\_\-eadp\-\_\-tea\-\_\-f}}
\index{max\-\_\-eadp\-\_\-tea\-\_\-f@{max\-\_\-eadp\-\_\-tea\-\_\-f}!eadp-tea-f.cc@{eadp-\/tea-\/f.\-cc}}
\paragraph[{max\-\_\-eadp\-\_\-tea\-\_\-f}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-eadp\-\_\-tea\-\_\-f} (
\begin{DoxyParamCaption}
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{const uint32\-\_\-t}]{da, }
\item[{uint32\-\_\-t $\ast$}]{dd\-\_\-max, }
\item[{double $\ast$}]{prob\-\_\-max, }
\item[{uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{eadp-tea-f_8cc_afecdbe906e7af3483f251d65512f85f7}
\-For fixed input difference {\ttfamily da}, compute an output difference {\ttfamily dd} that has maximum expected additive differential probability (\-E\-A\-D\-P) averaged over all round keys and constants of the \-F-\/function of \-T\-E\-A\-:

$\mathrm{max}_{dd}~\mathrm{eadp}^{F}(da \rightarrow dd) = 2^{-4n}~\{\#(k_0,k_1,\delta,x) : F(x + da) - F(x) = dd\}$.

{\bfseries \-Complexity\-:} $O(n)$.

{\bfseries \-Algorithm} {\bfseries sketch\-:} $\mathrm{eadp}^{F}$ is computed as the multiplication of \-A\-D\-P-\/s of the two non-\/linear (w.\-r.\-t. \-X\-O\-R differences) components of \-F, namely \-X\-O\-R and \-L\-S\-H\-:

\[\mathrm{eadp}^{F}(da \rightarrow dd) = (\sum^3_{i=0} (\mathrm{adp}^{\gg 5}(da, dc_i)))~ \cdot~ \mathrm{max}_{dd}~\mathrm{adp}^{3\oplus}_{\mathrm{SET}}((da \ll 4), da, \{dc_0, dc_1, dc_2, dc_3\} \rightarrow dd)\]

where $dc_i \in \{(da \gg 5), (da \gg 5) + 1, (da \gg 5) - 2^{n-5}, (da \gg 5) - 2^{n-5} + 1\}$ are the four possible \-A\-D\-D differences after \-R\-S\-H (see \hyperlink{adp-shift_8hh_a06fffd781af6662482922889bc562caf}{adp\-\_\-rsh}) and $\mathrm{max}_{dd}~\mathrm{adp}^{3\oplus}_{\mathrm{SET}}$ is the maximum \-A\-D\-P over all outpt differences, of \-X\-O\-R with three inputs where one of the inputs may satisfy any difference from a given {\itshape set\/} (\hyperlink{max-adp-xor3-set_8hh_a64619e5349dd07dc017b0469b4066fce}{max\-\_\-adp\-\_\-xor3\-\_\-set}).


\begin{DoxyParams}{\-Parameters}
{\em \-A} & transition probability matrices for $\mathrm{adp}^{3\oplus}$ (\hyperlink{adp-xor3_8hh_a229a19749624926d15eb5b1731379855}{adp\-\_\-xor3\-\_\-sf}). \\
\hline
{\em da} & input difference. \\
\hline
{\em dd\-\_\-max} & maximum probability output difference. \\
\hline
{\em prob\-\_\-max} & maximum expected \-D\-P of \-F over all output differences. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{max}_{db}~\mathrm{eadp}^{F}(da \rightarrow dd)$. 
\end{DoxyReturn}
\hypertarget{eadp-tea-f_8cc_a677d6b3bc42aae321e2f4a3ec91640d5}{\index{eadp-\/tea-\/f.\-cc@{eadp-\/tea-\/f.\-cc}!max\-\_\-eadp\-\_\-tea\-\_\-f\-\_\-exper@{max\-\_\-eadp\-\_\-tea\-\_\-f\-\_\-exper}}
\index{max\-\_\-eadp\-\_\-tea\-\_\-f\-\_\-exper@{max\-\_\-eadp\-\_\-tea\-\_\-f\-\_\-exper}!eadp-tea-f.cc@{eadp-\/tea-\/f.\-cc}}
\paragraph[{max\-\_\-eadp\-\_\-tea\-\_\-f\-\_\-exper}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf max\-\_\-eadp\-\_\-tea\-\_\-f\-\_\-exper} (
\begin{DoxyParamCaption}
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{const uint32\-\_\-t}]{da, }
\item[{uint32\-\_\-t $\ast$}]{dd\-\_\-max, }
\item[{double $\ast$}]{prob\-\_\-max, }
\item[{uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{uint32\-\_\-t}]{rsh\-\_\-const}
\end{DoxyParamCaption}
)}}\label{eadp-tea-f_8cc_a677d6b3bc42aae321e2f4a3ec91640d5}
\-Computing the maximum expected additive differential probability (\-E\-A\-D\-P) of the \-F-\/function of \-T\-E\-A (see \hyperlink{eadp-tea-f_8hh_a2b46cad5e0dd22f116160ef8fde6e15f}{eadp\-\_\-tea\-\_\-f}), experimentally over all round keys, round constants and output differences.

{\bfseries \-Complexity\-:} $O(2^{5n})$.


\begin{DoxyParams}{\-Parameters}
{\em \-A} & transition probability matrices for $\mathrm{adp}^{3\oplus}$ (\hyperlink{adp-xor3_8hh_a229a19749624926d15eb5b1731379855}{adp\-\_\-xor3\-\_\-sf}). \\
\hline
{\em da} & input difference. \\
\hline
{\em dd\-\_\-max} & output difference. \\
\hline
{\em prob\-\_\-max} & the maximum expected \-D\-P of \-F. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant. \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{eadp}^{F}(da \rightarrow db)$.
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{eadp-tea-f_8hh_afecdbe906e7af3483f251d65512f85f7}{max\-\_\-eadp\-\_\-tea\-\_\-f} 
\end{DoxySeeAlso}
\hypertarget{eadp-tea-f_8cc_a288ad628f2a68f2f32c7c065a2c87e82}{\index{eadp-\/tea-\/f.\-cc@{eadp-\/tea-\/f.\-cc}!nz\-\_\-eadp\-\_\-tea\-\_\-f@{nz\-\_\-eadp\-\_\-tea\-\_\-f}}
\index{nz\-\_\-eadp\-\_\-tea\-\_\-f@{nz\-\_\-eadp\-\_\-tea\-\_\-f}!eadp-tea-f.cc@{eadp-\/tea-\/f.\-cc}}
\paragraph[{nz\-\_\-eadp\-\_\-tea\-\_\-f}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf nz\-\_\-eadp\-\_\-tea\-\_\-f} (
\begin{DoxyParamCaption}
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{double}]{p\-\_\-thres, }
\item[{uint32\-\_\-t}]{da, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dd}
\end{DoxyParamCaption}
)}}\label{eadp-tea-f_8cc_a288ad628f2a68f2f32c7c065a2c87e82}
\-For fixed input diffference {\ttfamily da} to the \-T\-E\-A \-F-\/function, generate an arbitrary output difference {\ttfamily dd} for which the expected \-D\-P of \-F is above a fixed threshold i.\-e. $\mathrm{eadp}^{F}(da \rightarrow dd) > p_{\mathrm{thres}}$.


\begin{DoxyParams}{\-Parameters}
{\em \-A} & transition probability matrices for $\mathrm{adp}^{3\oplus}$ (\hyperlink{adp-xor3_8hh_a229a19749624926d15eb5b1731379855}{adp\-\_\-xor3\-\_\-sf}). \\
\hline
{\em p\-\_\-thres} & probability threshold. \\
\hline
{\em da} & first input difference to \-X\-O\-R3. \\
\hline
{\em ret\-\_\-dd} & output difference that is returned as result. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
$\mathrm{eadp}^{F}(da \rightarrow dd)$.
\end{DoxyReturn}
\begin{DoxyAttention}{\-Attention}
\-Although the resulting differential $(da \rightarrow dd)$ is guaranteed to have expected probability, averaged over all keys and constants, strictly bigger than zero, its probability may still be zero for some fixed value of the round keys and $\delta$ constants.
\end{DoxyAttention}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{eadp-tea-f_8hh_a934bdfebbd560419bbe519ce81d27bcf}{nz\-\_\-eadp\-\_\-tea\-\_\-f\-\_\-i} 
\end{DoxySeeAlso}
\hypertarget{eadp-tea-f_8cc_a934bdfebbd560419bbe519ce81d27bcf}{\index{eadp-\/tea-\/f.\-cc@{eadp-\/tea-\/f.\-cc}!nz\-\_\-eadp\-\_\-tea\-\_\-f\-\_\-i@{nz\-\_\-eadp\-\_\-tea\-\_\-f\-\_\-i}}
\index{nz\-\_\-eadp\-\_\-tea\-\_\-f\-\_\-i@{nz\-\_\-eadp\-\_\-tea\-\_\-f\-\_\-i}!eadp-tea-f.cc@{eadp-\/tea-\/f.\-cc}}
\paragraph[{nz\-\_\-eadp\-\_\-tea\-\_\-f\-\_\-i}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf nz\-\_\-eadp\-\_\-tea\-\_\-f\-\_\-i} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{k, }
\item[{const uint32\-\_\-t}]{n, }
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{gsl\-\_\-vector $\ast$}]{\-C, }
\item[{const uint32\-\_\-t}]{da, }
\item[{const uint32\-\_\-t}]{db, }
\item[{const uint32\-\_\-t}]{dc, }
\item[{uint32\-\_\-t $\ast$}]{dd, }
\item[{double $\ast$}]{p, }
\item[{double $\ast$}]{p\-\_\-thres, }
\item[{uint32\-\_\-t $\ast$}]{ret\-\_\-dd, }
\item[{double $\ast$}]{ret\-\_\-p, }
\item[{uint32\-\_\-t $\ast$}]{cnt, }
\item[{uint32\-\_\-t}]{max\-\_\-cnt}
\end{DoxyParamCaption}
)}}\label{eadp-tea-f_8cc_a934bdfebbd560419bbe519ce81d27bcf}
\-For fixed input diffferences {\ttfamily da}, {\ttfamily db} and {\ttfamily dc}, to the \-X\-O\-R operation with three inputs in the \-T\-E\-A \-F-\/function, generate an arbitrary output difference {\ttfamily dd} for which the expected \-D\-P of \-F is nonzero i.\-e. $\mathrm{eadp}^{F}(da \rightarrow dd) > 0$.

{\bfseries \-Complexity} c\-: $O(n) \le c \ll O(2^n)$.

{\bfseries \-Algorithm} {\bfseries sketch\-:} 

\-The function works recursively starting from the \-L\-S bit {\ttfamily k} = 0 and terminating at the \-M\-S bit {\ttfamily n}. \-At every bit position i it assigns values to the i-\/th bit of the output difference {\ttfamily dd} and evaluates the probability of the resulting partial (i+1)-\/bit differential\-: $(da[i:0], db[i:0], dc[i:0] \rightarrow dd[i:0])$. \-The recursion proceeds only if this probability is not less than the threshold {\ttfamily p\-\_\-thres}. \-When i = n, the difference $dd[n-1:0]$ is stored as the result and the probability $\mathrm{eadp}^{F}(da \rightarrow dd)$ is returned.

\begin{DoxyNote}{\-Note}
\-Note that the threshold {\ttfamily p\-\_\-thres} is initialized to 0.\-0, but is dynamically updated during the execution as soon as a higher value is found.
\end{DoxyNote}
\begin{DoxyAttention}{\-Attention}
\-Although the resulting differential $(da \rightarrow dd)$ is guaranteed to have expected probability, averaged over all keys and constants, strictly bigger than zero, its probability may still be zero for some fixed value of the round keys and $\delta$ constants.
\end{DoxyAttention}

\begin{DoxyParams}{\-Parameters}
{\em k} & current bit position in the recursion. \\
\hline
{\em n} & word size. \\
\hline
{\em \-A} & transition probability matrices for $\mathrm{adp}^{3\oplus}$ (\hyperlink{adp-xor3_8hh_a229a19749624926d15eb5b1731379855}{adp\-\_\-xor3\-\_\-sf}). \\
\hline
{\em \-C} & unit column vector for computing $\mathrm{adp}^{3\oplus}$ (\hyperlink{adp-xor3_8hh_a980a22f6faf155e031f0d9f7e8ca9361}{adp\-\_\-xor3}). \\
\hline
{\em da} & first input difference to \-X\-O\-R3. \\
\hline
{\em db} & second input difference to \-X\-O\-R3. \\
\hline
{\em dc} & third input difference to \-X\-O\-R3. \\
\hline
{\em dd} & output difference from \-X\-O\-R3 (and \-F). \\
\hline
{\em p} & probability of the differential $(da[k:0], db[k:0], dc[k:0] \rightarrow dd[k:0])$. \\
\hline
{\em p\-\_\-thres} & probability threshold. \\
\hline
{\em ret\-\_\-dd} & output difference that is returned as result. \\
\hline
{\em ret\-\_\-p} & the \-E\-D\-P $\mathrm{eadp}^{F}(da \rightarrow dd)$. \\
\hline
{\em cnt} & number of output differences generated so far. \\
\hline
{\em max\-\_\-cnt} & maximum number of output differences allowed (typically 1).\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{adp-xor-pddt_8hh_a2a98c59498fcf33df1976b272cf5809e}{adp\-\_\-xor\-\_\-ddt} 
\end{DoxySeeAlso}

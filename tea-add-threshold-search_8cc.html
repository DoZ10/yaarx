<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>YAARX: Yet Another ARX Toolkit: src/tea-add-threshold-search.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">YAARX: Yet Another ARX Toolkit
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('tea-add-threshold-search_8cc.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tea-add-threshold-search.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Automatic search for ADD differential trails in block cipher TEA.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="common_8hh_source.html">common.hh</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="adp-xor3_8hh_source.html">adp-xor3.hh</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tea_8hh_source.html">tea.hh</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="eadp-tea-f_8hh_source.html">eadp-tea-f.hh</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tea-f-add-pddt_8hh_source.html">tea-f-add-pddt.hh</a>&quot;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a50a3716bc83febae5e18ba2934aea8ab"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tea-add-threshold-search_8cc.html#a50a3716bc83febae5e18ba2934aea8ab">tea_add_threshold_count_lp</a> (<a class="el" href="structdifferential__t.html">differential_t</a> trail[<a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a>], uint32_t trail_len, double p_thres)</td></tr>
<tr class="separator:a50a3716bc83febae5e18ba2934aea8ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab59db616cde68bf9245c7d24c98e3a6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tea-add-threshold-search_8cc.html#ab59db616cde68bf9245c7d24c98e3a6c">tea_add_threshold_search</a> (const int n, const int nrounds, const uint32_t npairs, const uint32_t key[4], gsl_matrix *A[2][2][2][2], double B[<a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a>], double *Bn, const <a class="el" href="structdifferential__t.html">differential_t</a> diff_in[<a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a>], <a class="el" href="structdifferential__t.html">differential_t</a> trail[<a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a>], uint32_t lsh_const, uint32_t rsh_const, std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *diff_mset_p, std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *diff_set_dx_dy)</td></tr>
<tr class="separator:ab59db616cde68bf9245c7d24c98e3a6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31c22e11cd5abadd0e344a2c64a05a1d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a31c22e11cd5abadd0e344a2c64a05a1d"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>tea_add_is_trail_in_vector</b> (<a class="el" href="structdifferential__t.html">differential_t</a> trail[<a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a>], std::vector&lt; std::array&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a> &gt;&gt; trail_vec)</td></tr>
<tr class="separator:a31c22e11cd5abadd0e344a2c64a05a1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12916e7dd772f3ed8f1eea1b80bf5345"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tea-add-threshold-search_8cc.html#a12916e7dd772f3ed8f1eea1b80bf5345">tea_add_threshold_search_full</a> (const int n, const int nrounds, const uint32_t npairs, const uint32_t key[4], gsl_matrix *A[2][2][2][2], double B[<a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a>], double *Bn, const <a class="el" href="structdifferential__t.html">differential_t</a> diff_in[<a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a>], <a class="el" href="structdifferential__t.html">differential_t</a> trail[<a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a>], uint32_t lsh_const, uint32_t rsh_const, std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *diff_mset_p, std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *diff_set_dx_dy, std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *croads_diff_mset_p, std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *croads_diff_set_dx_dy, std::vector&lt; std::array&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a> &gt;&gt; *trail_vec)</td></tr>
<tr class="separator:a12916e7dd772f3ed8f1eea1b80bf5345"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0f68e80d4599027b9a5c581891af32f"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tea-add-threshold-search_8cc.html#aa0f68e80d4599027b9a5c581891af32f">tea_add_trail_search</a> (uint32_t key[4], double B[<a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a>], <a class="el" href="structdifferential__t.html">differential_t</a> trail[<a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a>])</td></tr>
<tr class="separator:aa0f68e80d4599027b9a5c581891af32f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad67aee37c1fb58e3236ddbe912574538"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tea-add-threshold-search_8cc.html#ad67aee37c1fb58e3236ddbe912574538">tea_add_trail_search_full</a> (uint32_t key[4], double BB[<a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a>], <a class="el" href="structdifferential__t.html">differential_t</a> trail[<a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a>], uint32_t num_rounds)</td></tr>
<tr class="separator:ad67aee37c1fb58e3236ddbe912574538"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Automatic search for ADD differential trails in block cipher TEA. </p>
<dl class="section author"><dt>Author</dt><dd>V.Velichkov, <a href="#" onclick="location.href='mai'+'lto:'+'ves'+'se'+'lin'+'.v'+'eli'+'ch'+'kov'+'@u'+'ni.'+'lu'; return false;">vesse<span style="display: none;">.nosp@m.</span>lin.<span style="display: none;">.nosp@m.</span>velic<span style="display: none;">.nosp@m.</span>hkov<span style="display: none;">.nosp@m.</span>@uni.<span style="display: none;">.nosp@m.</span>lu</a> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a50a3716bc83febae5e18ba2934aea8ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t tea_add_threshold_count_lp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdifferential__t.html">differential_t</a>&#160;</td>
          <td class="paramname"><em>trail</em>[NROUNDS], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>trail_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_thres</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Count the number of differentials in a <code>trail</code> that have probabilities below a given threshold.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trail</td><td>a differential trail for <code>trail_len</code> rounds. </td></tr>
    <tr><td class="paramname">trail_len</td><td>length of the differential trail. </td></tr>
    <tr><td class="paramname">p_thres</td><td>probability threshold. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab59db616cde68bf9245c7d24c98e3a6c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tea_add_threshold_search </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nrounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>npairs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>key</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_matrix *&#160;</td>
          <td class="paramname"><em>A</em>[2][2][2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>B</em>[NROUNDS], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Bn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdifferential__t.html">differential_t</a>&#160;</td>
          <td class="paramname"><em>diff_in</em>[NROUNDS], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdifferential__t.html">differential_t</a>&#160;</td>
          <td class="paramname"><em>trail</em>[NROUNDS], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>lsh_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>rsh_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *&#160;</td>
          <td class="paramname"><em>diff_mset_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *&#160;</td>
          <td class="paramname"><em>diff_set_dx_dy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Automatic search for ADD differential trails in block cipher TEA. using pDDT.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>index of the current round: <img class="formulaInl" alt="$0 \le n < \mathrm{nrounds}$" src="form_322.png"/>. </td></tr>
    <tr><td class="paramname">nrounds</td><td>total number of rounds (<a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a>). </td></tr>
    <tr><td class="paramname">npairs</td><td>number of chosen plaintext pairs (<a class="el" href="common_8hh.html#ad8bbd29e2946d6b269e0009219061ad6">NPAIRS</a>). </td></tr>
    <tr><td class="paramname">key</td><td>cryptographic key of TEA. </td></tr>
    <tr><td class="paramname">A</td><td>transition probability matrices for <img class="formulaInl" alt="$\mathrm{adp}^{3\oplus}$" src="form_138.png"/> (<a class="el" href="adp-xor3_8hh.html#a229a19749624926d15eb5b1731379855">adp_xor3_sf</a>). </td></tr>
    <tr><td class="paramname">B</td><td>array containing the best differential probabilities for i rounds: <img class="formulaInl" alt="$0 \le i < n$" src="form_323.png"/>. </td></tr>
    <tr><td class="paramname">Bn</td><td>the best probability on <img class="formulaInl" alt="$n$" src="form_10.png"/> rounds, updated dynamically. </td></tr>
    <tr><td class="paramname">diff_in</td><td>array of differentials. </td></tr>
    <tr><td class="paramname">trail</td><td>best found differential trail for <code>nrounds</code>. </td></tr>
    <tr><td class="paramname">lsh_const</td><td>LSH constant (TEA_LSH_CONST). </td></tr>
    <tr><td class="paramname">rsh_const</td><td>RSH constant (TEA_RSH_CONST). </td></tr>
    <tr><td class="paramname">diff_mset_p</td><td>set of differentials <img class="formulaInl" alt="$(dx,dy,p)$" src="form_339.png"/> (the pDDT) ordered by probability p. </td></tr>
    <tr><td class="paramname">diff_set_dx_dy</td><td>set of differentials <img class="formulaInl" alt="$(dx,dy,p)$" src="form_339.png"/> (the pDDT) ordered by index <img class="formulaInl" alt="$i = (dx~ 2^{n} + dy)$" src="form_340.png"/>.</td></tr>
  </table>
  </dd>
</dl>
<p>The outline of the array of bounds <img class="formulaInl" alt="$B$" src="form_324.png"/> is the following:</p>
<ul>
<li><img class="formulaInl" alt="$B[0]$" src="form_325.png"/>: best probability for <img class="formulaInl" alt="$1$" src="form_326.png"/> round.</li>
<li><img class="formulaInl" alt="$B[1]$" src="form_327.png"/>: best probability for <img class="formulaInl" alt="$2$" src="form_328.png"/> rounds.</li>
<li><img class="formulaInl" alt="$\ldots$" src="form_318.png"/></li>
<li><img class="formulaInl" alt="$B[i]$" src="form_329.png"/>: best probability for <img class="formulaInl" alt="$(i+1)$" src="form_109.png"/> rounds.</li>
<li><img class="formulaInl" alt="$\ldots$" src="form_318.png"/></li>
<li><img class="formulaInl" alt="$B[n-2]$" src="form_330.png"/>: best probability for <img class="formulaInl" alt="$(n-1)$" src="form_331.png"/> rounds.</li>
<li><img class="formulaInl" alt="$B[n-1]$" src="form_332.png"/>: best probability for <img class="formulaInl" alt="$n$" src="form_10.png"/> rounds.</li>
</ul>
<p><b>Algorithm</b> <b>Outline:</b> </p>
<p>The algorithm is based on Matsui search strategy described in [Sect. 4, Matsui, <a href="http://dblp.uni-trier.de/rec/bibtex/conf/eurocrypt/Matsui94">On correlation between the order of S-boxes and the strength of DES</a>, EUROCRYPT'94]. The main idea is to view the F-function of TEA as an S-box for which a partial difference distribution table (pDDT) is constructed (<a class="el" href="tea-f-add-pddt_8hh.html#af962bfb5724a4f1dd45fdb2fdeac49f4">tea_f_add_pddt</a>). Then a recursive search for differential trails over a given number of rounds <img class="formulaInl" alt="$n \ge 1$" src="form_341.png"/> is performed. From knowledge of the best probabilities <img class="formulaInl" alt="$B_{1}, B_{2}, \ldots, B_{n-1}$" src="form_342.png"/> for the first <img class="formulaInl" alt="$(n-1)$" src="form_331.png"/> rounds and an initial estimate <img class="formulaInl" alt="${\overline B_n}$" src="form_343.png"/> for the probability for <img class="formulaInl" alt="$n$" src="form_10.png"/> rounds the best probability <img class="formulaInl" alt="$B_{n}$" src="form_344.png"/> for <img class="formulaInl" alt="$n$" src="form_10.png"/> rounds is derived. Note that for the estimate the following must hold: <img class="formulaInl" alt="${\overline B_n} \leq B_n$" src="form_345.png"/>.</p>
<p>In addition to Matsui's notation for the probability of the best <img class="formulaInl" alt="$n$" src="form_10.png"/>-round trail <img class="formulaInl" alt="$B_n$" src="form_346.png"/> and of its estimation <img class="formulaInl" alt="${\overline B_n}$" src="form_343.png"/> we introduce <img class="formulaInl" alt="${\widehat B_n}$" src="form_347.png"/> to denote the probability of <em>the</em> <em>best</em> <em>found</em> trail for <img class="formulaInl" alt="$n$" src="form_10.png"/> rounds: <img class="formulaInl" alt="${\overline B_n} \leq {\widehat B_n} \leq B_n$" src="form_348.png"/>. Given a pDDT <img class="formulaInl" alt="$D$" src="form_349.png"/> of maximum size <img class="formulaInl" alt="$m$" src="form_350.png"/>, an estimation for the best <img class="formulaInl" alt="$n$" src="form_10.png"/>-round probability <img class="formulaInl" alt="${\overline B_n}$" src="form_343.png"/> with its corresponding <img class="formulaInl" alt="$n$" src="form_10.png"/>-round differential trail <img class="formulaInl" alt="${\overline T}$" src="form_351.png"/> and the probabilities <img class="formulaInl" alt="${{\widehat B_1}, {\widehat B_2}, \ldots, {\widehat B_{n-1}}}$" src="form_352.png"/> of the best found trails for the first <img class="formulaInl" alt="$(n - 1)$" src="form_353.png"/> rounds, <a class="el" href="tea-add-threshold-search_8cc.html#ab59db616cde68bf9245c7d24c98e3a6c">tea_add_threshold_search</a> outputs an <img class="formulaInl" alt="$n$" src="form_10.png"/>-round trail <img class="formulaInl" alt="${\widehat T}$" src="form_354.png"/> that has probability <img class="formulaInl" alt="${\widehat{B_n}} \ge {\overline B_n}$" src="form_355.png"/>.</p>
<p><a class="el" href="tea-add-threshold-search_8cc.html#ab59db616cde68bf9245c7d24c98e3a6c">tea_add_threshold_search</a> operates by recursively extending a trail for <img class="formulaInl" alt="$i$" src="form_57.png"/> rounds to <img class="formulaInl" alt="$(i+1)$" src="form_109.png"/> rounds, beginning with <img class="formulaInl" alt="$i = 1$" src="form_356.png"/> and terminating at <img class="formulaInl" alt="$i = n$" src="form_357.png"/>. This is done by exploring multiple differential trails constructed from the entries of the pDDT <img class="formulaInl" alt="$D$" src="form_349.png"/> at every round. If, in the process, a differential that is not already in <img class="formulaInl" alt="$D$" src="form_349.png"/> is encountered it is added to <img class="formulaInl" alt="$D$" src="form_349.png"/>, provided that the maximum size <img class="formulaInl" alt="$m$" src="form_350.png"/> has not been reached. The recursion at level <img class="formulaInl" alt="$i$" src="form_57.png"/> continues to level <img class="formulaInl" alt="$(i+1)$" src="form_109.png"/> only if the probability of the constructed <img class="formulaInl" alt="$i$" src="form_57.png"/>-round trail multiplied by the probability of the best found trail for <img class="formulaInl" alt="$(n - i)$" src="form_358.png"/> rounds is at least <img class="formulaInl" alt="${\overline B_n}$" src="form_343.png"/> i.e. if, <img class="formulaInl" alt="$p_1 p_2 \ldots p_i\, {\widehat B_{n - i}} \ge {\overline B_n}$" src="form_359.png"/> holds. For <img class="formulaInl" alt="$i = n$" src="form_357.png"/> the last equation is equivalent to: <img class="formulaInl" alt="$p_1 p_2 \ldots p_n = {\widehat B_{n}} \ge {\overline B_n}$" src="form_360.png"/>. If the latter holds, the initial estimate is updated with the new: <img class="formulaInl" alt="${\overline B_n} \gets {\widehat B_{n}}$" src="form_361.png"/> and the corresponding trail is also updated accordingly: <img class="formulaInl" alt="${\overline T_n} \gets {\widehat T_{n}}$" src="form_362.png"/>. Upon termination the best found trail <img class="formulaInl" alt="${\widehat T_{n}}$" src="form_363.png"/> and its probability <img class="formulaInl" alt="${\widehat{B_n}}$" src="form_364.png"/> are returned as result.</p>
<dl class="section attention"><dt>Attention</dt><dd>In the process of the search if an input differences <img class="formulaInl" alt="$\alpha$" src="form_365.png"/> is encountered for which a corresponding output difference <img class="formulaInl" alt="$\beta$" src="form_366.png"/> is not found in the pDDT (i.e. the differential <img class="formulaInl" alt="$(\alpha \rightarrow \beta_i)$" src="form_367.png"/> is not in the pDDT for no <img class="formulaInl" alt="$i$" src="form_57.png"/>), then an arbitarary non-zero probability output differnece <img class="formulaInl" alt="$\beta$" src="form_366.png"/> is computed with the <a class="el" href="eadp-tea-f_8hh.html#a288ad628f2a68f2f32c7c065a2c87e82">nz_eadp_tea_f</a> procedure . See also <a class="el" href="tea-add-threshold-search_8cc.html#a12916e7dd772f3ed8f1eea1b80bf5345">tea_add_threshold_search_full</a> where a more extensive search over the space of possible output differences <img class="formulaInl" alt="$\beta$" src="form_366.png"/> is performed in this case.</dd></dl>
<p><b>Termination</b> </p>
<p>The algorithm terminates when one of the following two events happens first:</p>
<ol type="1">
<li>The initial estimate <img class="formulaInl" alt="${\overline B_n}$" src="form_343.png"/> can not be improved further.</li>
<li>The maximum size <img class="formulaInl" alt="$m$" src="form_350.png"/> of the pDDT <img class="formulaInl" alt="$D$" src="form_349.png"/> is reached and all differentials in <img class="formulaInl" alt="$D$" src="form_349.png"/> in every round have been explored.</li>
</ol>
<p><b>Complexity</b> </p>
<p>The complexity of <a class="el" href="tea-add-threshold-search_8cc.html#ab59db616cde68bf9245c7d24c98e3a6c">tea_add_threshold_search</a> depends on the following factors:</p>
<ol type="1">
<li>The closeness of the best found probabilities <img class="formulaInl" alt="${{\widehat B_1}, {\widehat B_2}, \ldots, {\widehat B_{n-1}}}$" src="form_352.png"/> for the first <img class="formulaInl" alt="$(n - 1)$" src="form_353.png"/> rounds to the actual best probabilities.</li>
<li>The tightness of the initial estimate <img class="formulaInl" alt="${\overline B_n}$" src="form_343.png"/>.</li>
<li>The number of elements in <img class="formulaInl" alt="$D$" src="form_349.png"/>. The latter is determined by the probability threshold used to compute <img class="formulaInl" alt="$D$" src="form_349.png"/> and by the maximum number of elements <img class="formulaInl" alt="$m$" src="form_350.png"/> allowed.</li>
</ol>
<p>In the worst-case, in every round, except the last, <img class="formulaInl" alt="$m$" src="form_350.png"/> iterations will be executed. Therefore the worst-case complexity is <img class="formulaInl" alt="$\mathcal{O}(m^{n-1})$" src="form_368.png"/>, where <img class="formulaInl" alt="$n$" src="form_10.png"/> is the number of rounds. Although the algorithm is worst-case exponential in the number of rounds, it is much more efficient in practice.</p>
<dl class="section attention"><dt>Attention</dt><dd>The algorithm does not guarantee to find the <em>best</em> trail.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The pDDT of TEA contains the expected differential probabilities of F averaged over all keys and round constants. To obtain better estimate of the probabilities of trails for a fixed key and round constants, in the process of the search the probability of each differential is additionally adjusted to the value of the round key and constant by performing one-round encryptions over <code>npairs</code> pairs of chosen plaintexts.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="tea-add-threshold-search_8cc.html#a12916e7dd772f3ed8f1eea1b80bf5345">tea_add_threshold_search_full</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a12916e7dd772f3ed8f1eea1b80bf5345"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tea_add_threshold_search_full </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nrounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>npairs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>key</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_matrix *&#160;</td>
          <td class="paramname"><em>A</em>[2][2][2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>B</em>[NROUNDS], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Bn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdifferential__t.html">differential_t</a>&#160;</td>
          <td class="paramname"><em>diff_in</em>[NROUNDS], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdifferential__t.html">differential_t</a>&#160;</td>
          <td class="paramname"><em>trail</em>[NROUNDS], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>lsh_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>rsh_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *&#160;</td>
          <td class="paramname"><em>diff_mset_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *&#160;</td>
          <td class="paramname"><em>diff_set_dx_dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *&#160;</td>
          <td class="paramname"><em>croads_diff_mset_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *&#160;</td>
          <td class="paramname"><em>croads_diff_set_dx_dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::array&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a> &gt;&gt; *&#160;</td>
          <td class="paramname"><em>trail_vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Full threshold search for ADD differential trails in block cipher TEA, that uses initial bounds pre-computed with <a class="el" href="tea-add-threshold-search_8cc.html#ab59db616cde68bf9245c7d24c98e3a6c">tea_add_threshold_search</a> .</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>index of the current round: <img class="formulaInl" alt="$0 \le n < \mathrm{nrounds}$" src="form_322.png"/>. </td></tr>
    <tr><td class="paramname">nrounds</td><td>total number of rounds (<a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a>). </td></tr>
    <tr><td class="paramname">npairs</td><td>number of chosen plaintext pairs (<a class="el" href="common_8hh.html#ad8bbd29e2946d6b269e0009219061ad6">NPAIRS</a>). </td></tr>
    <tr><td class="paramname">key</td><td>cryptographic key of TEA. </td></tr>
    <tr><td class="paramname">A</td><td>transition probability matrices for <img class="formulaInl" alt="$\mathrm{adp}^{3\oplus}$" src="form_138.png"/> (<a class="el" href="adp-xor3_8hh.html#a229a19749624926d15eb5b1731379855">adp_xor3_sf</a>). </td></tr>
    <tr><td class="paramname">B</td><td>array of initial bounds pre-computed with <a class="el" href="tea-add-threshold-search_8cc.html#ab59db616cde68bf9245c7d24c98e3a6c">tea_add_threshold_search</a> . </td></tr>
    <tr><td class="paramname">Bn</td><td>the best probability on <img class="formulaInl" alt="$n$" src="form_10.png"/> rounds, updated dynamically. </td></tr>
    <tr><td class="paramname">diff_in</td><td>array of differentials. </td></tr>
    <tr><td class="paramname">trail</td><td>best found differential trail for <code>nrounds</code>. </td></tr>
    <tr><td class="paramname">lsh_const</td><td>LSH constant (TEA_LSH_CONST). </td></tr>
    <tr><td class="paramname">rsh_const</td><td>RSH constant (TEA_RSH_CONST). </td></tr>
    <tr><td class="paramname">diff_mset_p</td><td>set of differentials <img class="formulaInl" alt="$(dx,dy,p)$" src="form_339.png"/> (<b>Highways</b>) ordered by probability p. </td></tr>
    <tr><td class="paramname">diff_set_dx_dy</td><td>set of differentials <img class="formulaInl" alt="$(dx,dy,p)$" src="form_339.png"/> (<b>Highways</b>) ordered by index <img class="formulaInl" alt="$i = (dx~ 2^{n} + dy)$" src="form_340.png"/>. </td></tr>
    <tr><td class="paramname">croads_diff_mset_p</td><td>temporrary set of differentials <img class="formulaInl" alt="$(dx,dy,p)$" src="form_339.png"/> (<b>Countryroads</b>) ordered by probability p. </td></tr>
    <tr><td class="paramname">croads_diff_set_dx_dy</td><td>set of differentials <img class="formulaInl" alt="$(dx,dy,p)$" src="form_339.png"/> (<b>Countryroads</b>) ordered by index <img class="formulaInl" alt="$i = (dx~ 2^{n} + dy)$" src="form_340.png"/>.</td></tr>
  </table>
  </dd>
</dl>
<p><b>Algorithm</b> <b>Outline:</b> </p>
<p>The high-level logic of the algorithm is conceptually the same as <a class="el" href="tea-add-threshold-search_8cc.html#ab59db616cde68bf9245c7d24c98e3a6c">tea_add_threshold_search</a> . The main difference is in the way it handles the case when an input difference <img class="formulaInl" alt="$\alpha$" src="form_365.png"/> is encountered for which a corresponding output difference <img class="formulaInl" alt="$\beta$" src="form_366.png"/> is not found in the pre-computed pDDT. In this case a list of many possible output differences is computed and is explored during the search. More deatiled explanation follows.</p>
<p>Let <img class="formulaInl" alt="$\alpha_r$" src="form_369.png"/> be an input difference to round <img class="formulaInl" alt="$r$" src="form_27.png"/> such that the differential <img class="formulaInl" alt="$(\alpha_r \rightarrow \beta_i)$" src="form_370.png"/> is not in the pDDT for no value of <img class="formulaInl" alt="$i$" src="form_57.png"/>. In this case the algorithm uses <a class="el" href="tea-f-add-pddt_8hh.html#a379d6e4054b1bf78e6068f4cbdd06065">tea_f_da_add_pddt</a> to compute all differences <img class="formulaInl" alt="$\beta_i$" src="form_371.png"/> that satisfy the following conditions:</p>
<ol type="1">
<li>The differential <img class="formulaInl" alt="$(\alpha_r \rightarrow \beta_i)$" src="form_370.png"/> is such that its probability <img class="formulaInl" alt="$p_r$" src="form_372.png"/> can still improve the probability of the best found trail for the given number of rounds i.e. <img class="formulaInl" alt="$p_r \ge {{\overline B_n}}/{(p_1 p_2 \cdots p_{r-1} {\widehat B_{n-r}})}$" src="form_373.png"/>.</li>
<li>The output difference <img class="formulaInl" alt="$\beta_i$" src="form_371.png"/> is such that it guarantees that the input difference for the next round <img class="formulaInl" alt="$\alpha_{r+1} = \alpha_{r-1} + \beta_{i}$" src="form_374.png"/> will have a matching entry in the pre-computed pDDT. This condition guarantees that the resulting output difference <img class="formulaInl" alt="$\alpha_{r+1}$" src="form_375.png"/> for the next round will have a matching output differences <img class="formulaInl" alt="$\beta_{r+1}$" src="form_376.png"/> in the initial pDDT.</li>
</ol>
<p>All differentials <img class="formulaInl" alt="$(\alpha_r, \beta_r, p_r)$" src="form_377.png"/> computed according to the above rules are stored in a temporary pDDT. The differentials in this pDDT are explored during the next stages of the search togeter with the differentials from the initial pDDT.</p>
<p><b>The</b> <b>Highways</b> <b>and</b> <b>Countryroads</b> <b>Analogy</b> </p>
<p>Denote the temporary pDDT constructed as explained above by <img class="formulaInl" alt="$C$" src="form_378.png"/> and the initial pDDT that is pre-computed at the start of the search by <img class="formulaInl" alt="$ H $" src="form_379.png"/>. Then the two tables <img class="formulaInl" alt="$ H $" src="form_379.png"/> and <img class="formulaInl" alt="$C$" src="form_378.png"/> can be thought of as lists of <b>highways</b> and <b>countryroads</b> on a road map. The differentials contained in <img class="formulaInl" alt="$H$" src="form_380.png"/> have high probabilities w.r.t. to the fixed probability threshold and correspond therefore to fast roads such as <b>highways</b>. Analogously, the differentials in <img class="formulaInl" alt="$C$" src="form_378.png"/> have low probabilities and can be seen as slow roads or <b>countryroads</b>. To continue this analogy, the problem of finding a high probability differential trail for <img class="formulaInl" alt="$n$" src="form_10.png"/> rounds can be seen as a problem of finding a fast route between points <img class="formulaInl" alt="$1$" src="form_326.png"/> and <img class="formulaInl" alt="$n$" src="form_10.png"/> on the map. Clearly such a route must be composed of as many highways as possible. Condition (2), mentioned above, essentially guarantees that any country road that we may take in our search for a fast route will bring us back on a highway. Note that it is possible that the fastest route contains two or more country roads in sequence. While such a case will be missed, it may be accounted for by lowering the initial probability threshold.</p>
<p><b>Full</b> <b>Threshold</b> <b>Search</b> <b>Pseudo-Code</b> </p>
<div class="image">
<img src="threshold-search.png" alt="threshold-search.png"/>
<div class="caption">
Full Threshold Search Pseudo-Code</div></div>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="tea-add-threshold-search_8cc.html#ab59db616cde68bf9245c7d24c98e3a6c">tea_add_threshold_search</a> </dd></dl>

</div>
</div>
<a class="anchor" id="aa0f68e80d4599027b9a5c581891af32f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t tea_add_trail_search </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>key</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>B</em>[NROUNDS], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdifferential__t.html">differential_t</a>&#160;</td>
          <td class="paramname"><em>trail</em>[NROUNDS]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Search for ADD differential trails in block cipher TEA: wrapper function for <a class="el" href="tea-add-threshold-search_8cc.html#ab59db616cde68bf9245c7d24c98e3a6c">tea_add_threshold_search</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>cryptographic key of TEA. </td></tr>
    <tr><td class="paramname">B</td><td>array of bounds. </td></tr>
    <tr><td class="paramname">trail</td><td>best found differential trail.</td></tr>
  </table>
  </dd>
</dl>
<p><b>Algorithm</b> <b>Outline:</b> </p>
<p>The procedure operates as follows:</p>
<ol type="1">
<li>Compute a pDDT for F (<a class="el" href="tea-f-add-pddt_8hh.html#af962bfb5724a4f1dd45fdb2fdeac49f4">tea_f_add_pddt</a>).</li>
<li>Adjust the probabilities of the pDDT to the round key and constant (<a class="el" href="tea-f-add-pddt_8hh.html#aa60ac75c659872644ff116ea451bed41">tea_f_add_pddt_adjust_to_key</a>).</li>
<li>Execute the search for differential trails for <img class="formulaInl" alt="$n$" src="form_10.png"/> rounds (n = <a class="el" href="common_8hh.html#a92a76bc85ae6b57d8257f168e3927a29">NROUNDS</a>) through a successive application of <a class="el" href="tea-add-threshold-search_8cc.html#ab59db616cde68bf9245c7d24c98e3a6c">tea_add_threshold_search</a> :<ul>
<li>Compute the best found probability on 1 round: <img class="formulaInl" alt="$B[0]$" src="form_325.png"/>.</li>
<li>Using <img class="formulaInl" alt="$B[0]$" src="form_325.png"/> compute the best found probability on 2 rounds: <img class="formulaInl" alt="$B[1]$" src="form_327.png"/>.</li>
<li><img class="formulaInl" alt="$\ldots$" src="form_318.png"/></li>
<li>Using <img class="formulaInl" alt="$B[0],\ldots,B[i-1]$" src="form_381.png"/> compute the best found probability on <img class="formulaInl" alt="$(i+1)$" src="form_109.png"/> rounds: <img class="formulaInl" alt="$B[i]$" src="form_329.png"/>.</li>
<li><img class="formulaInl" alt="$\ldots$" src="form_318.png"/></li>
<li>Using <img class="formulaInl" alt="$B[0],\ldots,B[n-2]$" src="form_382.png"/> compute the best found probability on <img class="formulaInl" alt="$n$" src="form_10.png"/> rounds: <img class="formulaInl" alt="$B[n-1]$" src="form_332.png"/>.</li>
</ul>
</li>
<li>Print the best found trail on <img class="formulaInl" alt="$n$" src="form_10.png"/> rounds on standrad output and terminate.</li>
</ol>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="tea-add-threshold-search_8cc.html#ab59db616cde68bf9245c7d24c98e3a6c">tea_add_threshold_search</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ad67aee37c1fb58e3236ddbe912574538"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t tea_add_trail_search_full </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>key</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>BB</em>[NROUNDS], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdifferential__t.html">differential_t</a>&#160;</td>
          <td class="paramname"><em>trail</em>[NROUNDS], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>num_rounds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Full threshold search using bounds pre-computed with <a class="el" href="tea-add-threshold-search_8hh.html#aa0f68e80d4599027b9a5c581891af32f">tea_add_trail_search</a> ; basically a wrapper function for <a class="el" href="tea-add-threshold-search_8cc.html#a12916e7dd772f3ed8f1eea1b80bf5345">tea_add_threshold_search_full</a> .</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>cryptographic key of TEA. </td></tr>
    <tr><td class="paramname">BB</td><td>array of bounds. </td></tr>
    <tr><td class="paramname">trail</td><td>best found differential trail.</td></tr>
  </table>
  </dd>
</dl>
<p>The function takes as input an array of initial bounds <code>B</code> and the corresponding best found trail, computed with a prior call to <code>tea_add_trail_search</code> and outputs a trail that is at least as good as the niput.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="tea-add-threshold-search_8cc.html#a12916e7dd772f3ed8f1eea1b80bf5345">tea_add_threshold_search_full</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="tea-add-threshold-search_8cc.html">tea-add-threshold-search.cc</a></li>
    <li class="footer">Generated on Mon Apr 18 2016 16:53:09 for YAARX: Yet Another ARX Toolkit by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
